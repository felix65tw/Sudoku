<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ•¸ç¨éŠæˆ²</title>
    <style>
        /* CSSè®Šæ•¸å®šç¾© - äº®è‰²ä¸»é¡Œ */
        :root {
            --bg-color: #f5f7fa; /* èƒŒæ™¯é¡è‰² */
            --card-bg: #ffffff; /* å¡ç‰‡èƒŒæ™¯é¡è‰² */
            --text-color: #2c3e50; /* ä¸»è¦æ–‡å­—é¡è‰² */
            --text-secondary: #7f8c8d; /* æ¬¡è¦æ–‡å­—é¡è‰² */
            --primary: #3498db; /* ä¸»è¦é¡è‰² */
            --primary-light: #5dade2; /* ä¸»è¦é¡è‰²æ·ºè‰²ç‰ˆ */
            --success: #2ecc71; /* æˆåŠŸé¡è‰² */
            --success-light: #58d68d; /* æˆåŠŸé¡è‰²æ·ºè‰²ç‰ˆ */
            --danger: #e74c3c; /* å±éšªé¡è‰² */
            --warning: #f39c12; /* è­¦å‘Šé¡è‰² */
            --highlight: #e8f4fd; /* é«˜äº®é¡è‰² */
            --border: #bdc3c7; /* é‚Šæ¡†é¡è‰² */
            --shadow: rgba(0, 0, 0, 0.1); /* é™°å½±é¡è‰² */
            --disabled: #95a5a6; /* ç¦ç”¨ç‹€æ…‹é¡è‰² */
        }

        /* CSSè®Šæ•¸å®šç¾© - æš—è‰²ä¸»é¡Œ */
        .dark-theme {
            --bg-color: #1a1a2e; /* æš—è‰²èƒŒæ™¯é¡è‰² */
            --card-bg: #16213e; /* æš—è‰²å¡ç‰‡èƒŒæ™¯é¡è‰² */
            --text-color: #e6e6e6; /* æš—è‰²ä¸»è¦æ–‡å­—é¡è‰² */
            --text-secondary: #b0b0b0; /* æš—è‰²æ¬¡è¦æ–‡å­—é¡è‰² */
            --primary: #3498db; /* æš—è‰²ä¸»è¦é¡è‰² */
            --primary-light: #5dade2; /* æš—è‰²ä¸»è¦é¡è‰²æ·ºè‰²ç‰ˆ */
            --success: #2ecc71; /* æš—è‰²æˆåŠŸé¡è‰² */
            --success-light: #58d68d; /* æš—è‰²æˆåŠŸé¡è‰²æ·ºè‰²ç‰ˆ */
            --danger: #e74c3c; /* æš—è‰²å±éšªé¡è‰² */
            --warning: #f39c12; /* æš—è‰²è­¦å‘Šé¡è‰² */
            --highlight: #2c3e50; /* æš—è‰²é«˜äº®é¡è‰² */
            --border: #4a5568; /* æš—è‰²é‚Šæ¡†é¡è‰²ï¼Œæé«˜å¯è¦‹åº¦ */
            --shadow: rgba(0, 0, 0, 0.3); /* æš—è‰²é™°å½±é¡è‰² */
            --disabled: #7f8c8d; /* æš—è‰²ç¦ç”¨ç‹€æ…‹é¡è‰² */
        }

        /* é€šç”¨æ¨£å¼è¨­å®š */
        * {
            box-sizing: border-box; /* ç›’æ¨¡å‹è¨­å®š */
            touch-action: manipulation; /* è§¸æ§æ“ä½œå„ªåŒ– */
            -webkit-tap-highlight-color: transparent; /* ç§»é™¤é»æ“Šé«˜äº® */
        }

        /* ä¸»é«”æ¨£å¼ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; /* å­—é«”è¨­å®š */
            background-color: var(--bg-color); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            color: var(--text-color); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
            margin: 0; /* ç§»é™¤é è¨­é‚Šè· */
            padding: 10px; /* å…§é‚Šè· */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            flex-direction: column; /* å‚ç›´æ–¹å‘æ’åˆ— */
            align-items: center; /* æ°´å¹³ç½®ä¸­ */
            min-height: 100vh; /* æœ€å°é«˜åº¦ç‚ºè¦–çª—é«˜åº¦ */
            overflow: hidden; /* éš±è—æº¢å‡ºå…§å®¹ */
            transition: background-color 0.3s, color 0.3s; /* éæ¸¡æ•ˆæœ */
        }

        /* éŠæˆ²å®¹å™¨æ¨£å¼ */
        .game-container {
            width: 100%; /* å¯¬åº¦100% */
            max-width: 400px; /* æœ€å¤§å¯¬åº¦ */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            flex-direction: column; /* å‚ç›´æ–¹å‘æ’åˆ— */
            gap: 6px; /* å…ƒç´ é–“è· */
            overflow: hidden; /* éš±è—æº¢å‡ºå…§å®¹ */
        }

        /* é ‚éƒ¨æ§åˆ¶æ¬„æ¨£å¼ */
        .controls-top {
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            justify-content: space-between; /* å…©ç«¯å°é½Š */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            gap: 6px; /* å…ƒç´ é–“è· */
            flex-wrap: wrap; /* å…è¨±æ›è¡Œ */
            margin-top: 0; /* ä¸Šé‚Šè· */
            margin-bottom: 0; /* ä¸‹é‚Šè· */
        }

        /* æŒ‰éˆ•åŸºç¤æ¨£å¼ */
        .btn {
            padding: 6px 10px; /* å…§é‚Šè· */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 6px; /* åœ“è§’ */
            color: white; /* æ–‡å­—é¡è‰² */
            font-size: 0.9rem; /* å­—é«”å¤§å° */
            font-weight: 600; /* å­—é«”ç²—ç´° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            transition: all 0.2s; /* éæ¸¡æ•ˆæœ */
            flex: 1; /* å½ˆæ€§æ“´å±• */
            min-width: 0; /* æœ€å°å¯¬åº¦ */
            text-align: center; /* æ–‡å­—ç½®ä¸­ */
        }

        /* æŒ‰éˆ•é»æ“Šæ•ˆæœ */
        .btn:active {
            transform: scale(0.95); /* ç¸®å°æ•ˆæœ */
        }

        /* ä¸»è¦æŒ‰éˆ•æ¨£å¼ */
        .btn-primary {
            background-color: var(--primary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
        }

        /* æ¬¡è¦æŒ‰éˆ•æ¨£å¼ */
        .btn-secondary {
            background-color: var(--card-bg); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            color: var(--text-color); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
            border: 1px solid var(--border); /* ä½¿ç”¨è®Šæ•¸è¨­å®šé‚Šæ¡† */
        }

        /* é–‹å•Ÿç‹€æ…‹æŒ‰éˆ•æ¨£å¼ */
        .btn-on {
            background-color: var(--success); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            color: white; /* æ–‡å­—é¡è‰² */
        }

        /* åœ–æ¨™æŒ‰éˆ•æ¨£å¼ */
        .icon-btn {
            background: none; /* é€æ˜èƒŒæ™¯ */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            font-size: 1.5rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            padding: 8px; /* å…§é‚Šè· */
            border-radius: 6px; /* åœ“è§’ */
            transition: all 0.2s; /* éæ¸¡æ•ˆæœ */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
        }

        /* åœ–æ¨™æŒ‰éˆ•é»æ“Šæ•ˆæœ */
        .icon-btn:active {
            transform: scale(0.95); /* ç¸®å°æ•ˆæœ */
            background-color: rgba(0, 0, 0, 0.1); /* èƒŒæ™¯é¡è‰²è®ŠåŒ– */
        }

        /* ç‹€æ…‹æ¬„æ¨£å¼ */
        .status-bar {
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            justify-content: space-between; /* å…©ç«¯å°é½Š */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            font-size: 0.7rem; /* å­—é«”å¤§å° */
            padding: 0; /* å…§é‚Šè· */
            margin: 0; /* å¤–é‚Šè· */
            line-height: 0.5; /* è¡Œé«˜ */
            margin-top: 0; /* ä¸Šé‚Šè· */
        }

        /* è¨ˆæ™‚å™¨å®¹å™¨æ¨£å¼ */
        .timer-container {
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            gap: 5px; /* å…ƒç´ é–“è· */
        }

        /* è¨ˆæ™‚å™¨æ¨£å¼ */
        .timer {
            font-weight: 700; /* å­—é«”ç²—ç´° */
            font-family: monospace; /* ç­‰å¯¬å­—é«” */
            color: var(--primary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
        }

        /* æš«åœæŒ‰éˆ•æ¨£å¼ */
        .pause-btn {
            font-size: 0.7rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            color: var(--text-secondary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
            transition: color 0.2s; /* éæ¸¡æ•ˆæœ */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
            width: 5px; /* å¯¬åº¦ */
            height: 5px; /* é«˜åº¦ */
        }

        /* æš«åœæŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .pause-btn:hover {
            color: var(--primary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
        }

        /* çµ±è¨ˆè³‡è¨Šæ¨£å¼ */
        .stats {
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            gap: 12px; /* å…ƒç´ é–“è· */
        }

        /* çµ±è¨ˆé …ç›®æ¨£å¼ */
        .stat-item {
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            gap: 4px; /* å…ƒç´ é–“è· */
        }

        /* çµ±è¨ˆåœ–æ¨™æ¨£å¼ */
        .stat-icon {
            font-size: 1rem; /* å­—é«”å¤§å° */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
        }

        /* éŒ¯èª¤çµ±è¨ˆåœ–æ¨™æ¨£å¼ */
        .stat-icon.error {
            color: var(--danger); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
        }

        /* æç¤ºçµ±è¨ˆåœ–æ¨™æ¨£å¼ */
        .stat-icon.hint {
            color: var(--warning); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
        }

        /* çµ±è¨ˆæ•¸å€¼æ¨£å¼ */
        .stat-value {
            font-weight: 700; /* å­—é«”ç²—ç´° */
            font-family: monospace; /* ç­‰å¯¬å­—é«” */
            min-width: 20px; /* æœ€å°å¯¬åº¦ */
            text-align: center; /* æ–‡å­—ç½®ä¸­ */
            color: var(--text-color); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
        }

        /* æ•¸ç¨æ£‹ç›¤æ¨£å¼ */
        #sudoku-board {
            display: grid; /* ç¶²æ ¼ä½ˆå±€ */
            grid-template-columns: repeat(9, 1fr); /* 9åˆ—ç­‰å¯¬ */
            grid-template-rows: repeat(9, 1fr); /* 9è¡Œç­‰é«˜ */
            width: 100%; /* å¯¬åº¦100% */
            aspect-ratio: 1; /* å¯¬é«˜æ¯”1:1 */
            background-color: var(--border); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            border: 2px solid var(--border); /* ä½¿ç”¨è®Šæ•¸è¨­å®šé‚Šæ¡† */
            gap: 1px; /* ç¶²æ ¼é–“è· */
            border-radius: 4px; /* åœ“è§’ */
            overflow: hidden; /* éš±è—æº¢å‡ºå…§å®¹ */
            box-shadow: 0 4px 8px var(--shadow); /* é™°å½±æ•ˆæœ */
            transition: filter 0.3s ease; /* éæ¸¡æ•ˆæœ */
        }

        /* æ¨¡ç³Šç‹€æ…‹çš„æ•¸ç¨æ£‹ç›¤æ¨£å¼ */
        #sudoku-board.blurred {
            filter: blur(4px); /* æ¨¡ç³Šæ•ˆæœ */
            pointer-events: none; /* ç¦ç”¨é»æ“Šäº‹ä»¶ */
        }

        /* å–®å…ƒæ ¼æ¨£å¼ */
        .cell {
            background-color: var(--card-bg); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
            font-size: 1.6rem; /* å­—é«”å¤§å° */
            font-weight: 600; /* å­—é«”ç²—ç´° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            position: relative; /* ç›¸å°å®šä½ */
            user-select: none; /* ç¦æ­¢æ–‡å­—é¸æ“‡ */
            transition: background-color 0.3s, color 0.3s; /* éæ¸¡æ•ˆæœ */
        }

        /* ç·šç´¢å–®å…ƒæ ¼å’Œå·²å¡«å¯«å–®å…ƒæ ¼æ¨£å¼ */
        .cell.clue, .cell.filled {
            color: var(--primary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
            font-weight: 700; /* å­—é«”ç²—ç´° */
        }

        /* å³é‚Šæ¡†æ¨£å¼ */
        .cell.border-right { border-right: 2px solid var(--border); } /* ä½¿ç”¨è®Šæ•¸è¨­å®šå³é‚Šæ¡† */

        /* ä¸‹é‚Šæ¡†æ¨£å¼ */
        .cell.border-bottom { border-bottom: 2px solid var(--border); } /* ä½¿ç”¨è®Šæ•¸è¨­å®šä¸‹é‚Šæ¡† */

        /* ç›¸é—œå–®å…ƒæ ¼é«˜äº®æ¨£å¼ */
        .cell.highlight-related { background-color: var(--highlight); } /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */

        /* é¸ä¸­å–®å…ƒæ ¼æ¨£å¼ */
        .cell.selected { background-color: rgba(52, 152, 219, 0.2) !important; } /* åŠé€æ˜è—è‰²èƒŒæ™¯ */

        /* ç›¸åŒæ•¸å­—é«˜äº®æ¨£å¼ */
        .cell.highlight-same { background-color: rgba(52, 152, 219, 0.3) !important; } /* åŠé€æ˜è—è‰²èƒŒæ™¯ */

        /* éŒ¯èª¤å–®å…ƒæ ¼æ¨£å¼ */
        .cell.error { color: var(--danger); } /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */

        /* ç­†è¨˜ç¶²æ ¼æ¨£å¼ */
        .notes-grid {
            position: absolute; /* çµ•å°å®šä½ */
            top: 0; /* é ‚éƒ¨å°é½Š */
            left: 0; /* å·¦å´å°é½Š */
            width: 100%; /* å¯¬åº¦100% */
            height: 100%; /* é«˜åº¦100% */
            display: grid; /* ç¶²æ ¼ä½ˆå±€ */
            grid-template-columns: repeat(3, 1fr); /* 3åˆ—ç­‰å¯¬ */
            grid-template-rows: repeat(3, 1fr); /* 3è¡Œç­‰é«˜ */
            pointer-events: none; /* ç¦ç”¨é»æ“Šäº‹ä»¶ */
            padding: 1px; /* å…§é‚Šè· */
        }

        /* ç­†è¨˜æ•¸å­—æ¨£å¼ */
        .note-num {
            font-size: 0.7rem; /* å­—é«”å¤§å° */
            color: var(--text-secondary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
            line-height: 1; /* è¡Œé«˜ */
            font-weight: 500; /* å­—é«”ç²—ç´° */
        }

        /* é«˜äº®ç­†è¨˜æ•¸å­—æ¨£å¼ */
        .note-num.highlighted {
            background-color: var(--primary-light); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            color: white; /* æ–‡å­—é¡è‰² */
            border-radius: 2px; /* åœ“è§’ */
            font-weight: 600; /* å­—é«”ç²—ç´° */
        }

        /* æ•¸å­—éµç›¤æ¨£å¼ */
        .keypad {
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            gap: 6px; /* å…ƒç´ é–“è· */
            width: 100%; /* å¯¬åº¦100% */
            height: 50px; /* é«˜åº¦ */
        }

        /* æ•¸å­—æŒ‰éˆ•æ¨£å¼ */
        .numpad-btn {
            flex: 1; /* å½ˆæ€§æ“´å±• */
            background: var(--card-bg); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            border: 1px solid var(--border); /* ä½¿ç”¨è®Šæ•¸è¨­å®šé‚Šæ¡† */
            border-radius: 6px; /* åœ“è§’ */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            flex-direction: column; /* å‚ç›´æ–¹å‘æ’åˆ— */
            align-items: center; /* æ°´å¹³ç½®ä¸­ */
            justify-content: center; /* å‚ç›´ç½®ä¸­ */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            transition: all 0.2s; /* éæ¸¡æ•ˆæœ */
        }

        /* æ•¸å­—æŒ‰éˆ•é»æ“Šæ•ˆæœ */
        .numpad-btn:active {
            transform: scale(0.95); /* ç¸®å°æ•ˆæœ */
        }

        /* æ•¸å­—æ¨£å¼ */
        .numpad-btn .num {
            font-size: 1.2rem; /* å­—é«”å¤§å° */
            font-weight: 700; /* å­—é«”ç²—ç´° */
            color: var(--primary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
        }

        /* è¨ˆæ•¸æ¨£å¼ */
        .numpad-btn .count {
            font-size: 0.6rem; /* å­—é«”å¤§å° */
            color: var(--text-secondary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
            margin-top: 1px; /* ä¸Šé‚Šè· */
            line-height: 1; /* è¡Œé«˜ */
        }

        /* æ·¡å‡ºç‹€æ…‹çš„æ•¸å­—æŒ‰éˆ•æ¨£å¼ */
        .numpad-btn.faded {
            opacity: 0.4; /* é€æ˜åº¦ */
        }

        /* å»ºè­°æ•¸å­—æŒ‰éˆ•æ¨£å¼ */
        .numpad-btn.suggested {
            border: 2px solid var(--warning); /* ä½¿ç”¨è®Šæ•¸è¨­å®šé‚Šæ¡† */
            animation: pulse 1.5s infinite; /* è„ˆè¡å‹•ç•« */
        }

        /* è„ˆè¡å‹•ç•«å®šç¾© */
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0.4); } /* åˆå§‹ç‹€æ…‹ */
            70% { box-shadow: 0 0 0 6px rgba(243, 156, 18, 0); } /* ä¸­é–“ç‹€æ…‹ */
            100% { box-shadow: 0 0 0 0 rgba(243, 156, 18, 0); } /* çµæŸç‹€æ…‹ */
        }

        /* é®ç½©å±¤æ¨£å¼ */
        .overlay {
            position: fixed; /* å›ºå®šå®šä½ */
            top: 0; /* é ‚éƒ¨å°é½Š */
            left: 0; /* å·¦å´å°é½Š */
            width: 100%; /* å¯¬åº¦100% */
            height: 100%; /* é«˜åº¦100% */
            background: rgba(0, 0, 0, 0.7); /* åŠé€æ˜é»‘è‰²èƒŒæ™¯ */
            display: none; /* é è¨­éš±è— */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            z-index: 1000; /* å±¤ç´š */
        }

        /* æ¨¡æ…‹æ¡†æ¨£å¼ */
        .modal {
            background: var(--card-bg); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            padding: 30px; /* å…§é‚Šè· */
            border-radius: 16px; /* åœ“è§’ */
            text-align: center; /* æ–‡å­—ç½®ä¸­ */
            max-width: 90%; /* æœ€å¤§å¯¬åº¦ */
            width: 320px; /* å¯¬åº¦ */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); /* é™°å½±æ•ˆæœ */
            border: 2px solid var(--primary); /* ä½¿ç”¨è®Šæ•¸è¨­å®šé‚Šæ¡† */
            position: relative; /* ç›¸å°å®šä½ */
            overflow: hidden; /* éš±è—æº¢å‡ºå…§å®¹ */
        }

        /* å‹åˆ©æ¨¡æ…‹æ¡†æ¨£å¼ */
        .victory-modal {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); /* æ¼¸è®ŠèƒŒæ™¯ */
            color: #5a67d8; /* èª¿æ•´æ–‡å­—é¡è‰²ç‚ºæ›´è¼•é¬†çš„è—ç´«è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            animation: victory-appear 0.8s ease-out; /* å‹åˆ©å‡ºç¾å‹•ç•« */
            overflow: visible; /* é¡¯ç¤ºæº¢å‡ºå…§å®¹ */
        }

        /* å‹åˆ©æ¨¡æ…‹æ¡†æ¨™é¡Œæ¨£å¼ */
        .victory-modal h2 {
            margin-top: 0; /* ä¸Šé‚Šè· */
            font-size: 2.2rem; /* å­—é«”å¤§å° */
            margin-bottom: 20px; /* ä¸‹é‚Šè· */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* æ–‡å­—é™°å½± */
            color: #4c51bf; /* æ¨™é¡Œé¡è‰² */
        }

        /* å‹åˆ©æ¨¡æ…‹æ¡†æ®µè½æ¨£å¼ */
        .victory-modal p {
            color: #5a67d8; /* æ–‡å­—é¡è‰² */
            margin-bottom: 20px; /* ä¸‹é‚Šè· */
            font-size: 1.1rem; /* å­—é«”å¤§å° */
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); /* æ–‡å­—é™°å½± */
            font-weight: 500; /* å­—é«”ç²—ç´° */
        }

        /* å‹åˆ©æ¨¡æ…‹æ¡†æŒ‰éˆ•æ¨£å¼ */
        .victory-modal .modal-btn {
            background: rgba(255, 255, 255, 0.9); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            color: #667eea; /* æ–‡å­—é¡è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 8px; /* åœ“è§’ */
            font-size: 1.1rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            transition: all 0.3s; /* éæ¸¡æ•ˆæœ */
            padding: 12px 24px; /* å…§é‚Šè· */
            width: 100%; /* å¯¬åº¦100% */
            font-weight: 600; /* å­—é«”ç²—ç´° */
        }

        /* å‹åˆ©æ¨¡æ…‹æ¡†æŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .victory-modal .modal-btn:hover {
            background: white; /* ç™½è‰²èƒŒæ™¯ */
            transform: translateY(-2px); /* ä¸Šç§»æ•ˆæœ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* é™°å½±æ•ˆæœ */
        }

        /* å‹åˆ©æ¨¡æ…‹æ¡†æŒ‰éˆ•é»æ“Šæ•ˆæœ */
        .victory-modal .modal-btn:active {
            transform: translateY(0); /* é‚„åŸä½ç½® */
        }

        /* æš«åœæ¨¡æ…‹æ¡†æ¨£å¼ */
        .pause-modal {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); /* æ¼¸è®ŠèƒŒæ™¯ */
            color: #5a67d8; /* èª¿æ•´æ–‡å­—é¡è‰²ç‚ºæ›´è¼•é¬†çš„è—ç´«è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
        }

        /* æš«åœæ¨¡æ…‹æ¡†æ¨™é¡Œæ¨£å¼ */
        .pause-modal h2 {
            margin-top: 0; /* ä¸Šé‚Šè· */
            font-size: 1.8rem; /* å­—é«”å¤§å° */
            margin-bottom: 15px; /* ä¸‹é‚Šè· */
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* æ–‡å­—é™°å½± */
            color: #4c51bf; /* æ¨™é¡Œé¡è‰² */
        }

        /* æš«åœæ¨¡æ…‹æ¡†æ®µè½æ¨£å¼ */
        .pause-modal p {
            color: #5a67d8; /* æ–‡å­—é¡è‰² */
            margin-bottom: 20px; /* ä¸‹é‚Šè· */
            font-size: 1rem; /* å­—é«”å¤§å° */
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); /* æ–‡å­—é™°å½± */
        }

        /* æš«åœæ¨¡æ…‹æ¡†æŒ‰éˆ•æ¨£å¼ */
        .pause-modal .modal-btn {
            background: rgba(255, 255, 255, 0.9); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            color: #66a6ff; /* æ–‡å­—é¡è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 8px; /* åœ“è§’ */
            font-size: 1rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            transition: all 0.3s; /* éæ¸¡æ•ˆæœ */
            padding: 10px 20px; /* å…§é‚Šè· */
            width: 100%; /* å¯¬åº¦100% */
            font-weight: 600; /* å­—é«”ç²—ç´° */
        }

        /* æš«åœæ¨¡æ…‹æ¡†æŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .pause-modal .modal-btn:hover {
            background: white; /* ç™½è‰²èƒŒæ™¯ */
            transform: translateY(-2px); /* ä¸Šç§»æ•ˆæœ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* é™°å½±æ•ˆæœ */
        }

        /* æš«åœæ¨¡æ…‹æ¡†æŒ‰éˆ•é»æ“Šæ•ˆæœ */
        .pause-modal .modal-btn:active {
            transform: translateY(0); /* é‚„åŸä½ç½® */
        }

        /* è–ç¶“æ¨¡æ…‹æ¡†æ¨£å¼ */
        .bible-modal {
            background: linear-gradient(135deg, #fdfcfb 0%, #e2d1c3 100%); /* æ¼¸è®ŠèƒŒæ™¯ */
            color: #5d4037; /* æ–‡å­—é¡è‰² */
            border: 2px solid #8d6e63; /* é‚Šæ¡† */
            overflow-y: visible; /* é¡¯ç¤ºå‚ç›´æº¢å‡ºå…§å®¹ */
            width: 90%; /* å¯¬åº¦90% */
            max-width: 500px; /* æœ€å¤§å¯¬åº¦ */
            max-height: 90vh; /* æœ€å¤§é«˜åº¦ */
        }

        /* è–ç¶“æ¨¡æ…‹æ¡†æ¨™é¡Œæ¨£å¼ */
        .bible-modal h2 {
            margin-top: 0; /* ä¸Šé‚Šè· */
            font-size: 1.8rem; /* å­—é«”å¤§å° */
            margin-bottom: 20px; /* ä¸‹é‚Šè· */
            color: #5d4037; /* æ–‡å­—é¡è‰² */
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1); /* æ–‡å­—é™°å½± */
            border-bottom: 2px solid #8d6e63; /* åº•éƒ¨é‚Šæ¡† */
            padding-bottom: 10px; /* åº•éƒ¨å…§é‚Šè· */
        }

        /* è–ç¶“å…§å®¹æ¨£å¼ */
        .bible-content {
            text-align: left; /* æ–‡å­—å·¦å°é½Š */
            line-height: 1.8; /* è¡Œé«˜ */
            font-size: 1.1rem; /* å­—é«”å¤§å° */
            color: #4e342e; /* æ–‡å­—é¡è‰² */
            overflow-y: visible; /* é¡¯ç¤ºå‚ç›´æº¢å‡ºå…§å®¹ */
            padding: 15px; /* å…§é‚Šè· */
            background: rgba(255, 255, 255, 0.8); /* åŠé€æ˜ç™½è‰²èƒŒæ™¯ */
            border-radius: 8px; /* åœ“è§’ */
            margin-bottom: 20px; /* ä¸‹é‚Šè· */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* é™°å½±æ•ˆæœ */
        }

        /* è–ç¶“ç¶“æ–‡æ¨£å¼ */
        .bible-verse {
            margin-bottom: 15px; /* ä¸‹é‚Šè· */
            padding: 8px 0; /* ä¸Šä¸‹å…§é‚Šè· */
            border-bottom: 1px dashed #d7ccc8; /* åº•éƒ¨è™›ç·šé‚Šæ¡† */
            padding-left: 2.5em; /* å·¦å´å…§é‚Šè· */
            text-indent: -2.5em; /* é¦–è¡Œç¸®é€² */
        }

        /* æœ€å¾Œä¸€æ¢è–ç¶“ç¶“æ–‡æ¨£å¼ */
        .bible-verse:last-child {
            border-bottom: none; /* ç§»é™¤åº•éƒ¨é‚Šæ¡† */
        }

        /* ç¶“æ–‡ç·¨è™Ÿæ¨£å¼ */
        .verse-number {
            font-weight: bold; /* å­—é«”ç²—ç´° */
            color: #8d6e63; /* æ–‡å­—é¡è‰² */
            margin-right: 8px; /* å³é‚Šè· */
            display: inline-block; /* è¡Œå…§å¡Šå…ƒç´  */
            width: 2.5em; /* å¯¬åº¦ */
            text-align: right; /* æ–‡å­—å³å°é½Š */
        }

        /* è–ç¶“æ¨¡æ…‹æ¡†æŒ‰éˆ•æ¨£å¼ */
        .bible-modal .modal-btn {
            background: #8d6e63; /* èƒŒæ™¯é¡è‰² */
            color: white; /* æ–‡å­—é¡è‰² */
            border: none; /* ç§»é™¤é‚Šæ¡† */
            border-radius: 8px; /* åœ“è§’ */
            font-size: 1rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            transition: all 0.3s; /* éæ¸¡æ•ˆæœ */
            padding: 12px 24px; /* å…§é‚Šè· */
            width: 100%; /* å¯¬åº¦100% */
            font-weight: 600; /* å­—é«”ç²—ç´° */
            margin-top: 10px; /* ä¸Šé‚Šè· */
        }

        /* è–ç¶“æ¨¡æ…‹æ¡†æŒ‰éˆ•æ‡¸åœæ•ˆæœ */
        .bible-modal .modal-btn:hover {
            background: #6d4c41; /* èƒŒæ™¯é¡è‰²è®ŠåŒ– */
            transform: translateY(-2px); /* ä¸Šç§»æ•ˆæœ */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* é™°å½±æ•ˆæœ */
        }

        /* å‹åˆ©å‡ºç¾å‹•ç•«å®šç¾© */
        @keyframes victory-appear {
            0% {
                transform: scale(0.5) rotate(-10deg); /* åˆå§‹ç‹€æ…‹ï¼šç¸®å°ä¸¦æ—‹è½‰ */
                opacity: 0; /* å®Œå…¨é€æ˜ */
            }
            70% {
                transform: scale(1.05) rotate(5deg); /* ä¸­é–“ç‹€æ…‹ï¼šç¨å¾®æ”¾å¤§ä¸¦åå‘æ—‹è½‰ */
                opacity: 1; /* å®Œå…¨ä¸é€æ˜ */
            }
            100% {
                transform: scale(1) rotate(0); /* çµæŸç‹€æ…‹ï¼šæ­£å¸¸å¤§å°å’Œè§’åº¦ */
                opacity: 1; /* å®Œå…¨ä¸é€æ˜ */
            }
        }

        /* è–èª•ç‡ˆé£¾æ¨£å¼ */
        .christmas-lights {
            position: absolute; /* çµ•å°å®šä½ */
            top: -20px; /* é ‚éƒ¨ä½ç½® */
            left: 0; /* å·¦å´ä½ç½® */
            width: 100%; /* å¯¬åº¦100% */
            height: 30px; /* é«˜åº¦ */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            justify-content: space-around; /* å‡å‹»åˆ†ä½ˆ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            z-index: 10; /* å±¤ç´š */
        }

        /* ç‡ˆæ³¡æ¨£å¼ */
        .light {
            width: 15px; /* å¯¬åº¦ */
            height: 15px; /* é«˜åº¦ */
            border-radius: 50%; /* åœ“å½¢ */
            animation: light-twinkle 1.5s infinite; /* é–ƒçˆå‹•ç•« */
            box-shadow: 0 0 10px currentColor; /* ç™¼å…‰æ•ˆæœ */
        }

        /* ç‡ˆæ³¡é–ƒçˆå‹•ç•«å®šç¾© */
        @keyframes light-twinkle {
            0%, 100% {
                opacity: 0.3; /* é€æ˜åº¦ */
                transform: scale(0.8); /* ç¸®å° */
            }
            50% {
                opacity: 1; /* å®Œå…¨ä¸é€æ˜ */
                transform: scale(1.2); /* æ”¾å¤§ */
            }
        }

        /* æ–æ™ƒå‹•ç•«å®šç¾© */
        @keyframes shake {
            0% { transform: translateX(0); } /* åˆå§‹ä½ç½® */
            25% { transform: translateX(-3px); } /* å·¦ç§» */
            50% { transform: translateX(3px); } /* å³ç§» */
            75% { transform: translateX(-3px); } /* å·¦ç§» */
            100% { transform: translateX(0); } /* å›åˆ°åˆå§‹ä½ç½® */
        }

        /* éŒ¯èª¤å–®å…ƒæ ¼æ•¸å­—æ–æ™ƒæ•ˆæœ */
        .cell.error .main-num {
            animation: shake 0.4s ease-in-out; /* æ–æ™ƒå‹•ç•« */
        }

        /* æ–‡å­—é–ƒçˆå‹•ç•«å®šç¾© */
        @keyframes text-flash {
            0%, 100% { color: var(--primary); transform: scale(1); } /* åˆå§‹å’ŒçµæŸç‹€æ…‹ */
            50% { color: #f39c12; transform: scale(1.2); } /* ä¸­é–“ç‹€æ…‹ï¼šè®Šè‰²ä¸¦æ”¾å¤§ */
        }

        /* æç¤ºå–®å…ƒæ ¼æ•¸å­—é–ƒçˆæ•ˆæœ */
        .cell.hinting .main-num {
            animation: text-flash 0.6s ease-in-out 3; /* æ–‡å­—é–ƒçˆå‹•ç•«ï¼Œé‡è¤‡3æ¬¡ */
        }

        /* é›£åº¦é¸æ“‡å™¨æ¨£å¼ */
        .difficulty-select {
            background: var(--card-bg); /* ä½¿ç”¨è®Šæ•¸è¨­å®šèƒŒæ™¯é¡è‰² */
            border: 1px solid var(--border); /* ä½¿ç”¨è®Šæ•¸è¨­å®šé‚Šæ¡† */
            border-radius: 6px; /* åœ“è§’ */
            font-size: 0.9rem; /* å­—é«”å¤§å° */
            cursor: pointer; /* é¼ æ¨™æ¨£å¼ */
            padding: 6px 10px; /* å…§é‚Šè· */
            transition: all 0.2s; /* éæ¸¡æ•ˆæœ */
            display: flex; /* å½ˆæ€§ä½ˆå±€ */
            align-items: center; /* å‚ç›´ç½®ä¸­ */
            justify-content: center; /* æ°´å¹³ç½®ä¸­ */
            appearance: none; /* ç§»é™¤é è¨­æ¨£å¼ */
            -webkit-appearance: none; /* ç§»é™¤Webkitç€è¦½å™¨é è¨­æ¨£å¼ */
            -moz-appearance: none; /* ç§»é™¤Firefoxé è¨­æ¨£å¼ */
            color: var(--text-color); /* ä½¿ç”¨è®Šæ•¸è¨­å®šæ–‡å­—é¡è‰² */
            font-weight: 600; /* å­—é«”ç²—ç´° */
            min-width: 100px; /* æœ€å°å¯¬åº¦ */
            text-align: center; /* æ–‡å­—ç½®ä¸­ */
            text-align-last: center; /* æœ€å¾Œä¸€è¡Œæ–‡å­—ç½®ä¸­ */
        }

        /* é›£åº¦é¸æ“‡å™¨é»æ“Šæ•ˆæœ */
        .difficulty-select:active {
            transform: scale(0.95); /* ç¸®å°æ•ˆæœ */
            background-color: rgba(0, 0, 0, 0.05); /* èƒŒæ™¯é¡è‰²è®ŠåŒ– */
        }

        /* é›£åº¦é¸æ“‡å™¨é¸é …æ¨£å¼ */
        .difficulty-select option {
            text-align: center; /* æ–‡å­—ç½®ä¸­ */
            font-weight: 600; /* å­—é«”ç²—ç´° */
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ - å°å±å¹•è¨­å‚™ */
        @media (max-width: 480px) {
            .controls-top {
                gap: 4px; /* å…ƒç´ é–“è· */
                margin-top: 0; /* ä¸Šé‚Šè· */
                margin-bottom: 0; /* ä¸‹é‚Šè· */
            }
            
            .btn {
                padding: 5px 8px; /* å…§é‚Šè· */
                font-size: 0.8rem; /* å­—é«”å¤§å° */
            }
            
            .cell {
                font-size: 1.4rem; /* å­—é«”å¤§å° */
            }
            
            .numpad-btn .num {
                font-size: 1.1rem; /* å­—é«”å¤§å° */
            }
            
            .icon-btn {
                font-size: 1.3rem; /* å­—é«”å¤§å° */
            }
            
            .stat-icon {
                font-size: 0.9rem; /* å­—é«”å¤§å° */
            }
            
            .keypad {
                height: 45px; /* é«˜åº¦ */
            }
            
            .modal {
                padding: 20px; /* å…§é‚Šè· */
                width: 280px; /* å¯¬åº¦ */
            }
            
            .victory-modal h2 {
                font-size: 1.8rem; /* å­—é«”å¤§å° */
            }
            
            .victory-modal p {
                font-size: 1rem; /* å­—é«”å¤§å° */
            }
            
            .victory-modal .modal-btn {
                font-size: 1rem; /* å­—é«”å¤§å° */
            }
            
            .pause-modal h2 {
                font-size: 1.5rem; /* å­—é«”å¤§å° */
            }
            
            .pause-modal p {
                font-size: 0.9rem; /* å­—é«”å¤§å° */
            }
            
            .pause-modal .modal-btn {
                font-size: 0.9rem; /* å­—é«”å¤§å° */
            }
            
            .bible-modal {
                width: 95%; /* å¯¬åº¦95% */
                max-width: 95%; /* æœ€å¤§å¯¬åº¦95% */
                padding: 15px; /* å…§é‚Šè· */
            }
            
            .bible-modal h2 {
                font-size: 1.5rem; /* å­—é«”å¤§å° */
                margin-bottom: 15px; /* ä¸‹é‚Šè· */
            }
            
            .bible-content {
                font-size: 1rem; /* å­—é«”å¤§å° */
                padding: 10px; /* å…§é‚Šè· */
                line-height: 1.6; /* è¡Œé«˜ */
            }
            
            .bible-verse {
                margin-bottom: 12px; /* ä¸‹é‚Šè· */
                padding-left: 2em; /* å·¦å´å…§é‚Šè· */
                text-indent: -2em; /* é¦–è¡Œç¸®é€² */
            }
            
            .verse-number {
                width: 2em; /* å¯¬åº¦ */
            }
            
            .christmas-lights {
                top: -15px; /* é ‚éƒ¨ä½ç½® */
                height: 25px; /* é«˜åº¦ */
            }
            
            .light {
                width: 12px; /* å¯¬åº¦ */
                height: 12px; /* é«˜åº¦ */
            }
            
            .difficulty-select {
                font-size: 0.8rem; /* å­—é«”å¤§å° */
                min-width: 90px; /* æœ€å°å¯¬åº¦ */
                padding: 5px 8px; /* å…§é‚Šè· */
            }
        }
    </style>
</head>
<body>
    <!-- éŠæˆ²ä¸»å®¹å™¨ -->
    <div class="game-container">
        <!-- é ‚éƒ¨æ§åˆ¶æ¬„ -->
        <div class="controls-top">
            <!-- é›£åº¦é¸æ“‡ä¸‹æ‹‰é¸å–® -->
            <select class="difficulty-select" id="difficulty">
                <option value="Beginner">å…¥é–€</option> <!-- å…¥é–€é›£åº¦ -->
                <option value="Easy" selected>ç°¡å–®</option> <!-- ç°¡å–®é›£åº¦ï¼ˆé è¨­é¸æ“‡ï¼‰ -->
                <option value="Medium">ä¸­ç­‰</option> <!-- ä¸­ç­‰é›£åº¦ -->
                <option value="Hard">å›°é›£</option> <!-- å›°é›£é›£åº¦ -->
                <option value="Expert">å°ˆå®¶</option> <!-- å°ˆå®¶é›£åº¦ -->
            </select>
            
            <!-- æ–°éŠæˆ²æŒ‰éˆ• -->
            <button class="icon-btn" id="btn-new-game" title="æ–°éŠæˆ²">ğŸ”„</button>
            <!-- ç­†è¨˜æ¨¡å¼æŒ‰éˆ• -->
            <button class="icon-btn" id="btn-notes" title="ç­†è¨˜æ¨¡å¼">ğŸ“</button>
            <!-- æç¤ºæŒ‰éˆ• -->
            <button class="icon-btn" id="btn-hint" title="æç¤º">ğŸ’¡</button>
            <!-- éŸ³æ•ˆé–‹é—œæŒ‰éˆ• -->
            <button class="icon-btn" id="btn-sound" title="éŸ³æ•ˆ">ğŸ”Š</button>
            <!-- èªè¨€åˆ‡æ›æŒ‰éˆ• -->
            <button class="icon-btn" id="btn-language" title="èªè¨€">ğŸŒ</button>
            <!-- ä¸»é¡Œåˆ‡æ›æŒ‰éˆ• -->
            <button class="icon-btn" id="btn-theme" title="ä¸»é¡Œ">ğŸŒ™</button>
        </div>
        
        <!-- ç‹€æ…‹æ¬„ -->
        <div class="status-bar">
            <!-- è¨ˆæ™‚å™¨å®¹å™¨ -->
            <div class="timer-container">
                <!-- è¨ˆæ™‚å™¨é¡¯ç¤º -->
                <div class="timer" id="timer-display">00:00:00</div>
                <!-- æš«åœæŒ‰éˆ• -->
                <div class="pause-btn" id="pause-btn">â¸ï¸</div>
            </div>
            
            <!-- çµ±è¨ˆè³‡è¨Š -->
            <div class="stats">
                <!-- éŒ¯èª¤çµ±è¨ˆ -->
                <div class="stat-item">
                    <div class="stat-icon error">âŒ</div>
                    <span class="stat-value" id="error-stat">00</span>
                </div>
                <!-- æç¤ºçµ±è¨ˆ -->
                <div class="stat-item">
                    <div class="stat-icon hint">ğŸ’¡</div>
                    <span class="stat-value" id="hint-stat">00</span>
                </div>
            </div>
        </div>
        
        <!-- æ•¸ç¨æ£‹ç›¤ -->
        <div id="sudoku-board"></div>
        
        <!-- æ•¸å­—éµç›¤ -->
        <div class="keypad" id="keypad"></div>
    </div>

    <!-- å‹åˆ©ç•«é¢é®ç½©å±¤ -->
    <div class="overlay" id="victory-overlay">
        <div class="modal victory-modal">
            <!-- è–èª•ç‡ˆé£¾ -->
            <div class="christmas-lights" id="christmas-lights"></div>
            <!-- å‹åˆ©æ¨™é¡Œ -->
            <h2 id="victory-title">æ­å–œï¼</h2>
            <!-- å‹åˆ©æ™‚é–“é¡¯ç¤º -->
            <p id="victory-time-text">æ™‚é–“: 00:00:00</p>
            <!-- å‹åˆ©çµ±è¨ˆé¡¯ç¤º -->
            <p id="victory-stats">éŒ¯èª¤: 00, æç¤º: 00</p>
            <!-- å‹åˆ©ç¢ºå®šæŒ‰éˆ• -->
            <button class="modal-btn" onclick="closeOverlay()" id="victory-ok-btn">ç¢ºå®š</button>
        </div>
    </div>

    <!-- æš«åœç•«é¢é®ç½©å±¤ -->
    <div class="overlay" id="pause-overlay">
        <div class="modal pause-modal">
            <!-- æš«åœæ¨™é¡Œ -->
            <h2 id="pause-title">éŠæˆ²æš«åœ</h2>
            <!-- æš«åœæç¤ºæ–‡å­— -->
            <p id="pause-text">é»æ“ŠæŒ‰éˆ•ç¹¼çºŒ</p>
            <!-- ç¹¼çºŒéŠæˆ²æŒ‰éˆ• -->
            <button class="modal-btn" id="resume-btn" id="resume-btn-text">ç¹¼çºŒ</button>
        </div>
    </div>

    <!-- è–ç¶“å…§å®¹é®ç½©å±¤ -->
    <div class="overlay" id="bible-overlay">
        <div class="modal bible-modal">
            <!-- è–ç¶“æ¨™é¡Œ -->
            <h2 id="bible-title">è©©ç¯‡ 23ç¯‡</h2>
            <!-- è–ç¶“å…§å®¹å®¹å™¨ -->
            <div class="bible-content" id="bible-content"></div>
            <!-- é—œé–‰è–ç¶“æŒ‰éˆ• -->
            <button class="modal-btn" id="close-bible-btn" id="close-bible-text">é—œé–‰</button>
        </div>
    </div>

    <script>
        // éŠæˆ²ç‹€æ…‹è®Šæ•¸å®šç¾©
        let board = [];          // ç•¶å‰éŠæˆ²ç›¤é¢ï¼Œå­˜å„²ç©å®¶å¡«å¯«çš„æ•¸å­—
        let solution = [];       // å®Œæ•´è§£ç­”ï¼Œå­˜å„²æ­£ç¢ºçš„æ•¸ç¨è§£ç­”
        let initial = [];        // åˆå§‹ç›¤é¢ï¼Œå­˜å„²éŠæˆ²é–‹å§‹æ™‚çš„æ•¸å­—ï¼ˆç·šç´¢ï¼‰
        let selectedCell = null; // ç•¶å‰é¸ä¸­çš„å–®å…ƒæ ¼åº§æ¨™ {r, c}

        // éŠæˆ²åŠŸèƒ½ç‹€æ…‹
        let notesEnabled = false; // ç­†è¨˜æ¨¡å¼æ˜¯å¦å•Ÿç”¨
        let soundEnabled = true;  // éŸ³æ•ˆæ˜¯å¦å•Ÿç”¨
        let gameOver = false;     // éŠæˆ²æ˜¯å¦çµæŸ
        let isPaused = false;     // éŠæˆ²æ˜¯å¦æš«åœ

        // æ•¸å­—çµ±è¨ˆ
        let counts = Array(10).fill(9); // æ¯å€‹æ•¸å­—ï¼ˆ1-9ï¼‰å‰©é¤˜å¯å¡«å¯«çš„æ•¸é‡

        // è¨ˆæ™‚å™¨ç›¸é—œ
        let timerInterval = null; // è¨ˆæ™‚å™¨é–“éš”ID
        let timeElapsed = 0;      // ç¶“éçš„æ™‚é–“ï¼ˆç§’ï¼‰

        // éŠæˆ²çµ±è¨ˆ
        let errorCount = 0; // éŒ¯èª¤è¨ˆæ•¸
        let hintCount = 0;  // æç¤ºä½¿ç”¨è¨ˆæ•¸

        // ç§˜å¯†ä»£ç¢¼ç›¸é—œè®Šæ•¸
        let secretCode = [8,5,8,9,3,8,6,1]; // è§¸ç™¼è–ç¶“å…§å®¹çš„ç§˜å¯†ä»£ç¢¼
        let inputSequence = []; // ç©å®¶è¼¸å…¥çš„æ•¸å­—åºåˆ—
        let lastInputTime = 0;  // æœ€å¾Œä¸€æ¬¡è¼¸å…¥çš„æ™‚é–“æˆ³
        let isFreshGame = true; // æ˜¯å¦æ˜¯æ–°éŠæˆ²ï¼ˆç”¨æ–¼æª¢æ¸¬ç§˜å¯†ä»£ç¢¼ï¼‰

        // èªè¨€è¨­å®š
        let currentLanguage = 'zh-TW'; // ç•¶å‰èªè¨€ï¼Œé è¨­ç‚ºç¹é«”ä¸­æ–‡
        const translations = {
            'zh-TW': { // ç¹é«”ä¸­æ–‡ç¿»è­¯
                difficulty: {
                    'Beginner': 'å…¥é–€', // å…¥é–€é›£åº¦
                    'Easy': 'ç°¡å–®',     // ç°¡å–®é›£åº¦
                    'Medium': 'ä¸­ç­‰',   // ä¸­ç­‰é›£åº¦
                    'Hard': 'å›°é›£',     // å›°é›£é›£åº¦
                    'Expert': 'å°ˆå®¶'    // å°ˆå®¶é›£åº¦
                },
                victoryTitle: 'æ­å–œï¼', // å‹åˆ©æ¨™é¡Œ
                victoryTime: 'æ™‚é–“',    // å‹åˆ©æ™‚é–“
                victoryErrors: 'éŒ¯èª¤',  // å‹åˆ©éŒ¯èª¤çµ±è¨ˆ
                victoryHints: 'æç¤º',   // å‹åˆ©æç¤ºçµ±è¨ˆ
                victoryOK: 'ç¢ºå®š',      // å‹åˆ©ç¢ºå®šæŒ‰éˆ•
                pauseTitle: 'éŠæˆ²æš«åœ', // æš«åœæ¨™é¡Œ
                pauseText: 'é»æ“ŠæŒ‰éˆ•ç¹¼çºŒ', // æš«åœæç¤ºæ–‡å­—
                resume: 'ç¹¼çºŒ',         // ç¹¼çºŒæŒ‰éˆ•
                bibleTitle: 'è©©ç¯‡ 23ç¯‡', // è–ç¶“æ¨™é¡Œ
                closeBible: 'é—œé–‰',     // é—œé–‰è–ç¶“æŒ‰éˆ•
                newGame: 'æ–°éŠæˆ²',      // æ–°éŠæˆ²æŒ‰éˆ•æç¤º
                notesMode: 'ç­†è¨˜æ¨¡å¼',  // ç­†è¨˜æ¨¡å¼æŒ‰éˆ•æç¤º
                hint: 'æç¤º',           // æç¤ºæŒ‰éˆ•æç¤º
                sound: 'éŸ³æ•ˆ',          // éŸ³æ•ˆæŒ‰éˆ•æç¤º
                language: 'èªè¨€',       // èªè¨€æŒ‰éˆ•æç¤º
                theme: 'ä¸»é¡Œ'           // ä¸»é¡ŒæŒ‰éˆ•æç¤º
            },
            'zh-CN': { // ç°¡é«”ä¸­æ–‡ç¿»è­¯
                difficulty: {
                    'Beginner': 'å…¥é—¨',
                    'Easy': 'ç®€å•',
                    'Medium': 'ä¸­ç­‰',
                    'Hard': 'å›°éš¾',
                    'Expert': 'ä¸“å®¶'
                },
                victoryTitle: 'æ­å–œï¼',
                victoryTime: 'æ—¶é—´',
                victoryErrors: 'é”™è¯¯',
                victoryHints: 'æç¤º',
                victoryOK: 'ç¡®å®š',
                pauseTitle: 'æ¸¸æˆæš‚åœ',
                pauseText: 'ç‚¹å‡»æŒ‰é’®ç»§ç»­',
                resume: 'ç»§ç»­',
                bibleTitle: 'è¯—ç¯‡ 23ç¯‡',
                closeBible: 'å…³é—­',
                newGame: 'æ–°æ¸¸æˆ',
                notesMode: 'ç¬”è®°æ¨¡å¼',
                hint: 'æç¤º',
                sound: 'éŸ³æ•ˆ',
                language: 'è¯­è¨€',
                theme: 'ä¸»é¢˜'
            },
            'en': { // è‹±æ–‡ç¿»è­¯
                difficulty: {
                    'Beginner': 'Beginner',
                    'Easy': 'Easy',
                    'Medium': 'Medium',
                    'Hard': 'Hard',
                    'Expert': 'Expert'
                },
                victoryTitle: 'Congratulations!',
                victoryTime: 'Time',
                victoryErrors: 'Errors',
                victoryHints: 'Hints',
                victoryOK: 'OK',
                pauseTitle: 'Game Paused',
                pauseText: 'Click the button to continue',
                resume: 'Resume',
                bibleTitle: 'Psalm 23',
                closeBible: 'Close',
                newGame: 'New Game',
                notesMode: 'Notes Mode',
                hint: 'Hint',
                sound: 'Sound',
                language: 'Language',
                theme: 'Theme'
            }
        };

        // ä¸»é¡Œè¨­å®š
        let currentTheme = 'light'; // ç•¶å‰ä¸»é¡Œï¼Œé è¨­ç‚ºäº®è‰²ä¸»é¡Œ

        // éŸ³æ•ˆç³»çµ±
        const AudioContext = window.AudioContext || window.webkitAudioContext; // éŸ³é »ä¸Šä¸‹æ–‡
        let audioCtx = null; // éŸ³é »ä¸Šä¸‹æ–‡å¯¦ä¾‹

        // åˆå§‹åŒ–éŸ³æ•ˆç³»çµ±
        function initAudio() {
            // å¦‚æœéŸ³é »ä¸Šä¸‹æ–‡å°šæœªåˆå§‹åŒ–ï¼Œå‰‡å‰µå»ºæ–°çš„éŸ³é »ä¸Šä¸‹æ–‡
            if (!audioCtx) {
                audioCtx = new AudioContext();
            }
        }

        // æ’­æ”¾éŸ³æ•ˆ
        function playSound(type) {
            // å¦‚æœéŸ³æ•ˆæœªå•Ÿç”¨ï¼Œå‰‡ç›´æ¥è¿”å›
            if (!soundEnabled) return;
            
            // åˆå§‹åŒ–éŸ³æ•ˆç³»çµ±
            if (!audioCtx) initAudio();
            
            // å¦‚æœéŸ³é »ä¸Šä¸‹æ–‡è™•æ–¼æš«åœç‹€æ…‹ï¼Œå‰‡æ¢å¾©
            if (audioCtx.state === 'suspended') audioCtx.resume();
            
            const now = audioCtx.currentTime; // ç•¶å‰éŸ³é »æ™‚é–“
            
            // æ ¹æ“šéŸ³æ•ˆé¡å‹æ’­æ”¾ä¸åŒçš„è²éŸ³
            switch (type) {
                case 'correct': // æ­£ç¢ºç­”æ¡ˆéŸ³æ•ˆ
                    const oscCorrect = audioCtx.createOscillator(); // å‰µå»ºæŒ¯ç›ªå™¨
                    const gainNodeCorrect = audioCtx.createGain(); // å‰µå»ºå¢ç›Šç¯€é»
                    oscCorrect.connect(gainNodeCorrect); // é€£æ¥æŒ¯ç›ªå™¨å’Œå¢ç›Šç¯€é»
                    gainNodeCorrect.connect(audioCtx.destination); // é€£æ¥å¢ç›Šç¯€é»å’Œè¼¸å‡º
                    
                    oscCorrect.type = 'sine'; // æ­£å¼¦æ³¢
                    oscCorrect.frequency.setValueAtTime(1000, now); // è¨­ç½®é »ç‡
                    gainNodeCorrect.gain.setValueAtTime(0.3, now); // è¨­ç½®å¢ç›Š
                    gainNodeCorrect.gain.exponentialRampToValueAtTime(0.01, now + 0.1); // å¢ç›Šè¡°æ¸›
                    oscCorrect.start(now); // é–‹å§‹æ’­æ”¾
                    oscCorrect.stop(now + 0.1); // åœæ­¢æ’­æ”¾
                    break;
                    
                case 'error': // éŒ¯èª¤ç­”æ¡ˆéŸ³æ•ˆ
                    const oscError = audioCtx.createOscillator();
                    const gainNodeError = audioCtx.createGain();
                    oscError.connect(gainNodeError);
                    gainNodeError.connect(audioCtx.destination);
                    
                    oscError.type = 'sawtooth'; // é‹¸é½’æ³¢
                    oscError.frequency.setValueAtTime(150, now);
                    oscError.frequency.linearRampToValueAtTime(100, now + 0.3); // é »ç‡ç·šæ€§ä¸‹é™
                    gainNodeError.gain.setValueAtTime(0.2, now);
                    gainNodeError.gain.exponentialRampToValueAtTime(0.01, now + 0.3); // å¢ç›Šè¡°æ¸›
                    oscError.start(now);
                    oscError.stop(now + 0.3);
                    break;
                    
                case 'hint': // æç¤ºéŸ³æ•ˆ
                    const oscHint = audioCtx.createOscillator();
                    const gainNodeHint = audioCtx.createGain();
                    oscHint.connect(gainNodeHint);
                    gainNodeHint.connect(audioCtx.destination);
                    
                    oscHint.type = 'triangle'; // ä¸‰è§’æ³¢
                    oscHint.frequency.setValueAtTime(300, now);
                    oscHint.frequency.linearRampToValueAtTime(800, now + 0.3); // é »ç‡ç·šæ€§ä¸Šå‡
                    gainNodeHint.gain.setValueAtTime(0.1, now);
                    gainNodeHint.gain.linearRampToValueAtTime(0, now + 0.3); // å¢ç›Šç·šæ€§è¡°æ¸›
                    oscHint.start(now);
                    oscHint.stop(now + 0.3);
                    break;
                    
                case 'ui': // ç”¨æˆ¶ç•Œé¢éŸ³æ•ˆ
                    const oscUI = audioCtx.createOscillator();
                    const gainNodeUI = audioCtx.createGain();
                    oscUI.connect(gainNodeUI);
                    gainNodeUI.connect(audioCtx.destination);
                    
                    oscUI.type = 'square'; // æ–¹æ³¢
                    oscUI.frequency.setValueAtTime(800, now);
                    gainNodeUI.gain.setValueAtTime(0.05, now);
                    gainNodeUI.gain.exponentialRampToValueAtTime(0.01, now + 0.05); // å¿«é€Ÿè¡°æ¸›
                    oscUI.start(now);
                    oscUI.stop(now + 0.05);
                    break;
                    
                case 'win': // å‹åˆ©éŸ³æ•ˆ
                    playHappySound(now); // æ’­æ”¾æ­¡å¿«çš„å‹åˆ©éŸ³æ•ˆ
                    break;
            }
        }

        // æ’­æ”¾æ­¡å¿«çš„å‹åˆ©éŸ³æ•ˆ
        function playHappySound(startTime) {
            // åˆå§‹åŒ–éŸ³æ•ˆç³»çµ±
            if (!audioCtx) initAudio();
            
            // æ­¡å¿«çš„éŸ³éšåºåˆ—
            const melody = [
                523.25, 587.33, 659.25, 698.46, 783.99, 880.00, 987.77, 1046.50,
                987.77, 880.00, 783.99, 698.46, 659.25, 587.33, 523.25
            ];
            
            // ä¾æ¬¡æ’­æ”¾æ¯å€‹éŸ³ç¬¦
            melody.forEach((freq, index) => {
                const noteTime = startTime + index * 0.1; // è¨ˆç®—æ¯å€‹éŸ³ç¬¦çš„æ’­æ”¾æ™‚é–“
                playNote(freq, noteTime, 0.08); // æ’­æ”¾å–®å€‹éŸ³ç¬¦
            });
        }

        // æ’­æ”¾å–®å€‹éŸ³ç¬¦
        function playNote(frequency, time, duration) {
            // åˆå§‹åŒ–éŸ³æ•ˆç³»çµ±
            if (!audioCtx) initAudio();
            
            const oscillator = audioCtx.createOscillator(); // å‰µå»ºæŒ¯ç›ªå™¨
            const gainNode = audioCtx.createGain(); // å‰µå»ºå¢ç›Šç¯€é»
            
            oscillator.connect(gainNode); // é€£æ¥æŒ¯ç›ªå™¨å’Œå¢ç›Šç¯€é»
            gainNode.connect(audioCtx.destination); // é€£æ¥å¢ç›Šç¯€é»å’Œè¼¸å‡º
            
            oscillator.type = 'sine'; // æ­£å¼¦æ³¢
            oscillator.frequency.setValueAtTime(frequency, time); // è¨­ç½®é »ç‡
            
            gainNode.gain.setValueAtTime(0.1, time); // è¨­ç½®å¢ç›Š
            gainNode.gain.exponentialRampToValueAtTime(0.001, time + duration); // å¢ç›Šè¡°æ¸›
            
            oscillator.start(time); // é–‹å§‹æ’­æ”¾
            oscillator.stop(time + duration); // åœæ­¢æ’­æ”¾
        }

        // åˆå§‹åŒ–èˆ‡äº‹ä»¶ç›£è½è¨­ç½®
        document.addEventListener('DOMContentLoaded', () => {
            createBoardHTML(); // å‰µå»ºæ•¸ç¨æ£‹ç›¤HTMLçµæ§‹
            createKeypadHTML(); // å‰µå»ºæ•¸å­—éµç›¤HTMLçµæ§‹
            startNewGame(); // é–‹å§‹æ–°éŠæˆ²
            setupEventListeners(); // è¨­ç½®äº‹ä»¶ç›£è½å™¨
            loadBibleContent(); // åŠ è¼‰è–ç¶“å…§å®¹
            updateUIForLanguage(); // æ ¹æ“šç•¶å‰èªè¨€æ›´æ–°UI
        });

        // è¨­ç½®äº‹ä»¶ç›£è½å™¨
        function setupEventListeners() {
            // æ–°éŠæˆ²æŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('btn-new-game').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                startNewGame(); // é–‹å§‹æ–°éŠæˆ²
            });
            
            // ç­†è¨˜æ¨¡å¼æŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('btn-notes').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                toggleNotes(); // åˆ‡æ›ç­†è¨˜æ¨¡å¼
            });
            
            // æç¤ºæŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('btn-hint').addEventListener('click', () => {
                useHint(); // ä½¿ç”¨æç¤º
            });
            
            // éŸ³æ•ˆé–‹é—œæŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('btn-sound').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                toggleSound(); // åˆ‡æ›éŸ³æ•ˆç‹€æ…‹
            });
            
            // èªè¨€æŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('btn-language').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                toggleLanguage(); // åˆ‡æ›èªè¨€
            });
            
            // ä¸»é¡ŒæŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('btn-theme').addEventListener('click', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                toggleTheme(); // åˆ‡æ›ä¸»é¡Œ
            });
            
            // é›£åº¦é¸æ“‡è®ŠåŒ–äº‹ä»¶
            document.getElementById('difficulty').addEventListener('change', () => {
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
                startNewGame(); // é–‹å§‹æ–°éŠæˆ²
            });
            
            // æš«åœæŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('pause-btn').addEventListener('click', () => {
                togglePause(); // åˆ‡æ›æš«åœç‹€æ…‹
            });
            
            // ç¹¼çºŒéŠæˆ²æŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('resume-btn').addEventListener('click', () => {
                togglePause(); // åˆ‡æ›æš«åœç‹€æ…‹
            });
            
            // é—œé–‰è–ç¶“æŒ‰éˆ•é»æ“Šäº‹ä»¶
            document.getElementById('close-bible-btn').addEventListener('click', () => {
                closeBibleOverlay(); // é—œé–‰è–ç¶“å…§å®¹
            });
        }

        // åˆ‡æ›èªè¨€
        function toggleLanguage() {
            // å¾ªç’°åˆ‡æ›èªè¨€ï¼šç¹é«”ä¸­æ–‡ -> ç°¡é«”ä¸­æ–‡ -> è‹±æ–‡ -> ç¹é«”ä¸­æ–‡
            if (currentLanguage === 'zh-TW') {
                currentLanguage = 'zh-CN';
            } else if (currentLanguage === 'zh-CN') {
                currentLanguage = 'en';
            } else {
                currentLanguage = 'zh-TW';
            }
            
            updateUIForLanguage(); // æ ¹æ“šæ–°èªè¨€æ›´æ–°UI
        }

        // æ ¹æ“šç•¶å‰èªè¨€æ›´æ–°UI
        function updateUIForLanguage() {
            const t = translations[currentLanguage]; // ç²å–ç•¶å‰èªè¨€çš„ç¿»è­¯
            
            // æ›´æ–°é›£åº¦é¸æ“‡é¸é …
            const difficultySelect = document.getElementById('difficulty');
            difficultySelect.innerHTML = ''; // æ¸…ç©ºç¾æœ‰é¸é …
            
            const difficulties = ['Beginner', 'Easy', 'Medium', 'Hard', 'Expert']; // æ‰€æœ‰é›£åº¦ç´šåˆ¥
            // ç‚ºæ¯å€‹é›£åº¦ç´šåˆ¥å‰µå»ºé¸é …
            difficulties.forEach(diff => {
                const option = document.createElement('option');
                option.value = diff;
                option.textContent = t.difficulty[diff]; // ä½¿ç”¨ç¿»è­¯æ–‡æœ¬
                difficultySelect.appendChild(option);
            });
            
            // è¨­ç½®ç•¶å‰é¸æ“‡çš„é›£åº¦ç‚º"ç°¡å–®"
            difficultySelect.value = 'Easy';
            
            // æ›´æ–°å‹åˆ©ç•«é¢æ–‡å­—
            document.getElementById('victory-title').textContent = t.victoryTitle;
            document.getElementById('victory-time-text').textContent = `${t.victoryTime}: 00:00:00`;
            document.getElementById('victory-stats').textContent = `${t.victoryErrors}: 00, ${t.victoryHints}: 00`;
            document.getElementById('victory-ok-btn').textContent = t.victoryOK;
            
            // æ›´æ–°æš«åœç•«é¢æ–‡å­—
            document.getElementById('pause-title').textContent = t.pauseTitle;
            document.getElementById('pause-text').textContent = t.pauseText;
            document.getElementById('resume-btn').textContent = t.resume;
            
            // æ›´æ–°è–ç¶“ç•«é¢æ–‡å­—
            document.getElementById('bible-title').textContent = t.bibleTitle;
            document.getElementById('close-bible-btn').textContent = t.closeBible;
            
            // æ›´æ–°æŒ‰éˆ•æ¨™é¡Œ
            document.getElementById('btn-new-game').title = t.newGame;
            document.getElementById('btn-notes').title = t.notesMode;
            document.getElementById('btn-hint').title = t.hint;
            document.getElementById('btn-sound').title = t.sound;
            document.getElementById('btn-language').title = t.language;
            document.getElementById('btn-theme').title = t.theme;
            
            // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
            updateStats();
        }

        // åˆ‡æ›ä¸»é¡Œ
        function toggleTheme() {
            if (currentTheme === 'light') {
                currentTheme = 'dark'; // åˆ‡æ›åˆ°æš—è‰²ä¸»é¡Œ
                document.body.classList.add('dark-theme'); // æ·»åŠ æš—è‰²ä¸»é¡Œé¡
                document.getElementById('btn-theme').innerHTML = 'â˜€ï¸'; // åˆ‡æ›ç‚ºå¤ªé™½åœ–æ¨™
                document.getElementById('btn-theme').title = 'äº®è‰²ä¸»é¡Œ'; // æ›´æ–°æŒ‰éˆ•æç¤º
            } else {
                currentTheme = 'light'; // åˆ‡æ›åˆ°äº®è‰²ä¸»é¡Œ
                document.body.classList.remove('dark-theme'); // ç§»é™¤æš—è‰²ä¸»é¡Œé¡
                document.getElementById('btn-theme').innerHTML = 'ğŸŒ™'; // åˆ‡æ›ç‚ºæœˆäº®åœ–æ¨™
                document.getElementById('btn-theme').title = 'æš—è‰²ä¸»é¡Œ'; // æ›´æ–°æŒ‰éˆ•æç¤º
            }
            
            // æ›´æ–°ä¹å®®æ ¼æ ¼ç·šé¡è‰²
            updateBoardBorders();
        }

        // æ›´æ–°ä¹å®®æ ¼æ ¼ç·šé¡è‰²
        function updateBoardBorders() {
            const cells = document.querySelectorAll('.cell'); // ç²å–æ‰€æœ‰å–®å…ƒæ ¼
            cells.forEach(cell => {
                // ç§»é™¤æ‰€æœ‰é‚Šæ¡†é¡
                cell.classList.remove('border-right', 'border-bottom');
                
                const r = parseInt(cell.dataset.r); // ç²å–è¡Œç´¢å¼•
                const c = parseInt(cell.dataset.c); // ç²å–åˆ—ç´¢å¼•
                
                // é‡æ–°æ·»åŠ é‚Šæ¡†é¡
                if ((c + 1) % 3 === 0 && c !== 8) cell.classList.add('border-right'); // å³é‚Šæ¡†
                if ((r + 1) % 3 === 0 && r !== 8) cell.classList.add('border-bottom'); // ä¸‹é‚Šæ¡†
            });
        }

        // éŠæˆ²æ ¸å¿ƒåŠŸèƒ½ - é–‹å§‹æ–°éŠæˆ²
        function startNewGame() {
            // å¦‚æœéŠæˆ²è™•æ–¼æš«åœç‹€æ…‹ï¼Œå‰‡å–æ¶ˆæš«åœ
            if (isPaused) togglePause();
            
            const diff = document.getElementById('difficulty').value; // ç²å–é¸ä¸­çš„é›£åº¦
            
            generateSudoku(diff); // ç”Ÿæˆæ•¸ç¨éŠæˆ²
            
            // é‡ç½®éŠæˆ²ç‹€æ…‹
            gameOver = false;
            selectedCell = null;
            errorCount = 0;
            hintCount = 0;
            
            // é‡ç½®ç§˜å¯†ä»£ç¢¼ç›¸é—œè®Šæ•¸
            inputSequence = [];
            lastInputTime = 0;
            isFreshGame = true;
            
            // æ›´æ–°UI
            updateStats();
            updateBoardUI();
            updateCounts();
            updateHighlighting();
            
            startTimer(); // é–‹å§‹è¨ˆæ™‚
        }

        // å‰µå»ºæ•¸ç¨æ£‹ç›¤HTMLçµæ§‹
        function createBoardHTML() {
            const boardEl = document.getElementById('sudoku-board'); // ç²å–æ£‹ç›¤å…ƒç´ 
            boardEl.innerHTML = ''; // æ¸…ç©ºæ£‹ç›¤
            
            // å‰µå»º9x9çš„å–®å…ƒæ ¼
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const cell = document.createElement('div'); // å‰µå»ºå–®å…ƒæ ¼å…ƒç´ 
                    cell.className = 'cell'; // æ·»åŠ å–®å…ƒæ ¼é¡
                    cell.dataset.r = r; // è¨­ç½®è¡Œç´¢å¼•æ•¸æ“šå±¬æ€§
                    cell.dataset.c = c; // è¨­ç½®åˆ—ç´¢å¼•æ•¸æ“šå±¬æ€§
                    
                    // æ·»åŠ ä¹å®®æ ¼é‚Šæ¡†
                    if ((c + 1) % 3 === 0 && c !== 8) cell.classList.add('border-right');
                    if ((r + 1) % 3 === 0 && r !== 8) cell.classList.add('border-bottom');
                    
                    // å‰µå»ºç­†è¨˜ç¶²æ ¼
                    const notesDiv = document.createElement('div');
                    notesDiv.className = 'notes-grid';
                    // å‰µå»º9å€‹ç­†è¨˜æ•¸å­—
                    for(let i = 1; i <= 9; i++) {
                        const note = document.createElement('div');
                        note.className = 'note-num';
                        note.dataset.num = i; // è¨­ç½®æ•¸å­—æ•¸æ“šå±¬æ€§
                        notesDiv.appendChild(note);
                    }
                    cell.appendChild(notesDiv); // å°‡ç­†è¨˜ç¶²æ ¼æ·»åŠ åˆ°å–®å…ƒæ ¼
                    
                    // å‰µå»ºä¸»æ•¸å­—é¡¯ç¤ºå€åŸŸ
                    const numSpan = document.createElement('span');
                    numSpan.className = 'main-num';
                    cell.appendChild(numSpan); // å°‡æ•¸å­—é¡¯ç¤ºå€åŸŸæ·»åŠ åˆ°å–®å…ƒæ ¼
                    
                    // æ·»åŠ å–®å…ƒæ ¼é»æ“Šäº‹ä»¶
                    cell.addEventListener('click', () => selectCell(r, c));
                    boardEl.appendChild(cell); // å°‡å–®å…ƒæ ¼æ·»åŠ åˆ°æ£‹ç›¤
                }
            }
        }

        // å‰µå»ºæ•¸å­—éµç›¤HTMLçµæ§‹
        function createKeypadHTML() {
            const keypad = document.getElementById('keypad'); // ç²å–æ•¸å­—éµç›¤å…ƒç´ 
            keypad.innerHTML = ''; // æ¸…ç©ºæ•¸å­—éµç›¤
            
            // å‰µå»º1-9çš„æ•¸å­—æŒ‰éˆ•
            for (let i = 1; i <= 9; i++) {
                const btn = document.createElement('div'); // å‰µå»ºæŒ‰éˆ•å…ƒç´ 
                btn.className = 'numpad-btn'; // æ·»åŠ æ•¸å­—æŒ‰éˆ•é¡
                btn.id = `btn-num-${i}`; // è¨­ç½®æŒ‰éˆ•ID
                btn.innerHTML = `<div class="num">${i}</div><div class="count">9</div>`; // è¨­ç½®æŒ‰éˆ•å…§å®¹
                btn.addEventListener('click', () => handleInput(i)); // æ·»åŠ é»æ“Šäº‹ä»¶
                keypad.appendChild(btn); // å°‡æŒ‰éˆ•æ·»åŠ åˆ°æ•¸å­—éµç›¤
            }
        }

        // é¸æ“‡å–®å…ƒæ ¼
        function selectCell(r, c) {
            // å¦‚æœéŠæˆ²çµæŸæˆ–æš«åœï¼Œå‰‡ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
            if (gameOver || isPaused) return;
            
            selectedCell = { r, c }; // è¨­ç½®ç•¶å‰é¸ä¸­çš„å–®å…ƒæ ¼
            
            updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
            
            playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
        }

        // è™•ç†æ•¸å­—è¼¸å…¥
        function handleInput(num) {
            // å¦‚æœéŠæˆ²çµæŸæˆ–æš«åœï¼Œå‰‡ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
            if (gameOver || isPaused) return;
            
            checkSecretCode(num); // æª¢æŸ¥ç§˜å¯†ä»£ç¢¼
            
            // å¦‚æœæ²’æœ‰é¸ä¸­çš„å–®å…ƒæ ¼ï¼Œå‰‡ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
            if (!selectedCell) return;
            
            const { r, c } = selectedCell; // ç²å–é¸ä¸­å–®å…ƒæ ¼çš„åº§æ¨™
            
            // å¦‚æœæ˜¯åˆå§‹ç·šç´¢å–®å…ƒæ ¼æˆ–å·²æ­£ç¢ºå¡«å¯«çš„å–®å…ƒæ ¼ï¼Œå‰‡ä¸å…è¨±ä¿®æ”¹
            if (initial[r][c] !== 0 || (board[r][c] !== 0 && board[r][c] === solution[r][c])) return;
            
            const cellDiv = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
            
            // å¦‚æœè¼¸å…¥çš„æ•¸å­—æ­£ç¢º
            if (num === solution[r][c]) {
                board[r][c] = num; // æ›´æ–°éŠæˆ²ç›¤é¢
                playSound('correct'); // æ’­æ”¾æ­£ç¢ºéŸ³æ•ˆ
                updateBoardUI(); // æ›´æ–°æ£‹ç›¤UI
                updateCounts(); // æ›´æ–°æ•¸å­—è¨ˆæ•¸
                updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
                checkWin(); // æª¢æŸ¥æ˜¯å¦ç²å‹
                
                isFreshGame = false; // æ¨™è¨˜éŠæˆ²å·²é–‹å§‹
            } else {
                // è¼¸å…¥çš„æ•¸å­—éŒ¯èª¤
                playSound('error'); // æ’­æ”¾éŒ¯èª¤éŸ³æ•ˆ
                errorCount++; // å¢åŠ éŒ¯èª¤è¨ˆæ•¸
                updateStats(); // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
                
                // é¡¯ç¤ºéŒ¯èª¤æ•¸å­—
                cellDiv.querySelector('.main-num').innerText = num;
                cellDiv.classList.add('error'); // æ·»åŠ éŒ¯èª¤é¡
                cellDiv.classList.add('filled'); // æ·»åŠ å·²å¡«å¯«é¡
                
                // 0.5ç§’å¾Œæ¢å¾©é¡¯ç¤º
                setTimeout(() => {
                    cellDiv.classList.remove('error'); // ç§»é™¤éŒ¯èª¤é¡
                    cellDiv.querySelector('.main-num').innerText = board[r][c] === 0 ? '' : board[r][c]; // æ¢å¾©é¡¯ç¤º
                    cellDiv.classList.remove('filled'); // ç§»é™¤å·²å¡«å¯«é¡
                    if (notesEnabled) updateNotes(); // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨ï¼Œæ›´æ–°ç­†è¨˜
                }, 500);
                
                isFreshGame = false; // æ¨™è¨˜éŠæˆ²å·²é–‹å§‹
            }
        }

        // æª¢æŸ¥ç§˜å¯†ä»£ç¢¼
        function checkSecretCode(num) {
            // å¦‚æœä¸æ˜¯æ–°éŠæˆ²ï¼Œå‰‡ä¸æª¢æŸ¥ç§˜å¯†ä»£ç¢¼
            if (!isFreshGame) return;
            
            const currentTime = Date.now(); // ç•¶å‰æ™‚é–“æˆ³
            
            // å¦‚æœè·é›¢ä¸Šæ¬¡è¼¸å…¥è¶…é3ç§’ï¼Œå‰‡é‡ç½®è¼¸å…¥åºåˆ—
            if (currentTime - lastInputTime > 3000) {
                inputSequence = [];
            }
            
            inputSequence.push(num); // å°‡è¼¸å…¥çš„æ•¸å­—æ·»åŠ åˆ°åºåˆ—
            lastInputTime = currentTime; // æ›´æ–°æœ€å¾Œè¼¸å…¥æ™‚é–“
            
            // å¦‚æœåºåˆ—é•·åº¦è¶…éç§˜å¯†ä»£ç¢¼é•·åº¦ï¼Œå‰‡ç§»é™¤ç¬¬ä¸€å€‹å…ƒç´ 
            if (inputSequence.length > secretCode.length) {
                inputSequence.shift();
            }
            
            // å¦‚æœåºåˆ—é•·åº¦ç­‰æ–¼ç§˜å¯†ä»£ç¢¼é•·åº¦
            if (inputSequence.length === secretCode.length) {
                let isMatch = true; // åŒ¹é…æ¨™è¨˜
                
                // æª¢æŸ¥åºåˆ—æ˜¯å¦èˆ‡ç§˜å¯†ä»£ç¢¼åŒ¹é…
                for (let i = 0; i < secretCode.length; i++) {
                    if (inputSequence[i] !== secretCode[i]) {
                        isMatch = false; // ä¸åŒ¹é…
                        break;
                    }
                }
                
                // å¦‚æœåŒ¹é…ï¼Œé¡¯ç¤ºè–ç¶“å…§å®¹
                if (isMatch) {
                    showBibleOverlay(); // é¡¯ç¤ºè–ç¶“å…§å®¹
                    inputSequence = []; // é‡ç½®è¼¸å…¥åºåˆ—
                    isFreshGame = false; // æ¨™è¨˜éŠæˆ²å·²é–‹å§‹
                }
            }
        }

        // é¡¯ç¤ºè–ç¶“å…§å®¹
        function showBibleOverlay() {
            document.getElementById('bible-overlay').style.display = 'flex'; // é¡¯ç¤ºè–ç¶“å…§å®¹é®ç½©å±¤
            playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
        }

        // é—œé–‰è–ç¶“å…§å®¹
        function closeBibleOverlay() {
            document.getElementById('bible-overlay').style.display = 'none'; // éš±è—è–ç¶“å…§å®¹é®ç½©å±¤
            playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
        }

        // åŠ è¼‰è–ç¶“å…§å®¹
        function loadBibleContent() {
            const bibleContent = document.getElementById('bible-content'); // ç²å–è–ç¶“å…§å®¹å®¹å™¨
            
            // è©©ç¯‡23ç¯‡å…§å®¹
            const psalms23 = [
                { number: 1, text: "è€¶å’Œè¯æ˜¯æˆ‘çš„ç‰§è€…ï¼Œæˆ‘å¿…ä¸è‡´ç¼ºä¹ã€‚" },
                { number: 2, text: "ä»–ä½¿æˆ‘èººè‡¥åœ¨é’è‰åœ°ä¸Šï¼Œé ˜æˆ‘åœ¨å¯å®‰æ­‡çš„æ°´é‚Šã€‚" },
                { number: 3, text: "ä»–ä½¿æˆ‘çš„éˆé­‚ç”¦é†’ï¼Œç‚ºè‡ªå·±çš„åå¼•å°æˆ‘èµ°ç¾©è·¯ã€‚" },
                { number: 4, text: "æˆ‘é›–ç„¶è¡Œéæ­»è”­çš„å¹½è°·ï¼Œä¹Ÿä¸æ€•é­å®³ï¼Œå› ç‚ºä½ èˆ‡æˆ‘åŒåœ¨ï¼›ä½ çš„æ–ï¼Œä½ çš„ç«¿ï¼Œéƒ½å®‰æ…°æˆ‘ã€‚" },
                { number: 5, text: "åœ¨æˆ‘æ•µäººé¢å‰ï¼Œä½ ç‚ºæˆ‘æ“ºè¨­ç­µå¸­ï¼›ä½ ç”¨æ²¹è†äº†æˆ‘çš„é ­ï¼Œä½¿æˆ‘çš„ç¦æ¯æ»¿æº¢ã€‚" },
                { number: 6, text: "æˆ‘ä¸€ç”Ÿä¸€ä¸–å¿…æœ‰æ©æƒ æ…ˆæ„›éš¨è‘—æˆ‘ï¼›æˆ‘ä¸”è¦ä½åœ¨è€¶å’Œè¯çš„æ®¿ä¸­ï¼Œç›´åˆ°æ°¸é ã€‚" }
            ];
            
            bibleContent.innerHTML = ''; // æ¸…ç©ºè–ç¶“å…§å®¹å®¹å™¨
            
            // ç‚ºæ¯ç¯€ç¶“æ–‡å‰µå»ºDOMå…ƒç´ 
            psalms23.forEach(verse => {
                const verseElement = document.createElement('div');
                verseElement.className = 'bible-verse';
                
                const verseNumber = document.createElement('span');
                verseNumber.className = 'verse-number';
                verseNumber.textContent = verse.number + '.'; // ç¶“æ–‡ç·¨è™Ÿ
                
                const verseText = document.createElement('span');
                verseText.textContent = verse.text; // ç¶“æ–‡å…§å®¹
                
                verseElement.appendChild(verseNumber); // æ·»åŠ ç¶“æ–‡ç·¨è™Ÿ
                verseElement.appendChild(verseText); // æ·»åŠ ç¶“æ–‡å…§å®¹
                
                bibleContent.appendChild(verseElement); // å°‡ç¶“æ–‡æ·»åŠ åˆ°å®¹å™¨
            });
        }

        // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
        function updateStats() {
            const t = translations[currentLanguage]; // ç²å–ç•¶å‰èªè¨€çš„ç¿»è­¯
            
            // æ›´æ–°éŒ¯èª¤çµ±è¨ˆé¡¯ç¤º
            document.getElementById('error-stat').innerText = errorCount.toString().padStart(2, '0');
            // æ›´æ–°æç¤ºçµ±è¨ˆé¡¯ç¤º
            document.getElementById('hint-stat').innerText = hintCount.toString().padStart(2, '0');
            
            // æ›´æ–°å‹åˆ©ç•«é¢çµ±è¨ˆé¡¯ç¤º
            document.getElementById('victory-stats').innerText = `${t.victoryErrors}: ${errorCount.toString().padStart(2, '0')}, ${t.victoryHints}: ${hintCount.toString().padStart(2, '0')}`;
        }

        // é–‹å§‹è¨ˆæ™‚å™¨
        function startTimer() {
            stopTimer(); // åœæ­¢ç¾æœ‰è¨ˆæ™‚å™¨
            timeElapsed = 0; // é‡ç½®ç¶“éæ™‚é–“
            isPaused = false; // å–æ¶ˆæš«åœç‹€æ…‹
            updateTimerDisplay(); // æ›´æ–°è¨ˆæ™‚å™¨é¡¯ç¤º
            
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡è¨ˆæ™‚å™¨
            timerInterval = setInterval(() => {
                // å¦‚æœéŠæˆ²æœªæš«åœä¸”æœªçµæŸï¼Œå‰‡å¢åŠ ç¶“éæ™‚é–“
                if (!isPaused && !gameOver) {
                    timeElapsed++;
                    updateTimerDisplay(); // æ›´æ–°è¨ˆæ™‚å™¨é¡¯ç¤º
                }
            }, 1000);
        }

        // åœæ­¢è¨ˆæ™‚å™¨
        function stopTimer() {
            // å¦‚æœè¨ˆæ™‚å™¨æ­£åœ¨é‹è¡Œï¼Œå‰‡æ¸…é™¤å®ƒ
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        // æ›´æ–°è¨ˆæ™‚å™¨é¡¯ç¤º
        function updateTimerDisplay() {
            const t = translations[currentLanguage]; // ç²å–ç•¶å‰èªè¨€çš„ç¿»è­¯
            const hours = Math.floor(timeElapsed / 3600); // è¨ˆç®—å°æ™‚
            const minutes = Math.floor((timeElapsed % 3600) / 60); // è¨ˆç®—åˆ†é˜
            const seconds = timeElapsed % 60; // è¨ˆç®—ç§’æ•¸
            // æ ¼å¼åŒ–æ™‚é–“å­—ç¬¦ä¸²
            const text = `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            document.getElementById('timer-display').innerText = text; // æ›´æ–°ä¸»è¨ˆæ™‚å™¨é¡¯ç¤º
            document.getElementById('victory-time-text').innerText = `${t.victoryTime}: ${text}`; // æ›´æ–°å‹åˆ©ç•«é¢è¨ˆæ™‚å™¨é¡¯ç¤º
            return text; // è¿”å›æ ¼å¼åŒ–æ™‚é–“å­—ç¬¦ä¸²
        }

        // åˆ‡æ›æš«åœç‹€æ…‹
        function togglePause() {
            isPaused = !isPaused; // åˆ‡æ›æš«åœç‹€æ…‹
            
            if (isPaused) {
                // å¦‚æœæš«åœï¼Œé¡¯ç¤ºæš«åœç•«é¢
                document.getElementById('pause-overlay').style.display = 'flex';
                document.getElementById('sudoku-board').classList.add('blurred'); // æ¨¡ç³Šæ£‹ç›¤
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
            } else {
                // å¦‚æœå–æ¶ˆæš«åœï¼Œéš±è—æš«åœç•«é¢
                document.getElementById('pause-overlay').style.display = 'none';
                document.getElementById('sudoku-board').classList.remove('blurred'); // å–æ¶ˆæ¨¡ç³Šæ£‹ç›¤
                playSound('ui'); // æ’­æ”¾UIéŸ³æ•ˆ
            }
        }

        // æ•¸ç¨ç”Ÿæˆèˆ‡é©—è­‰ç®—æ³•
        // ç”Ÿæˆæ•¸ç¨éŠæˆ²
        function generateSudoku(difficulty) {
            board = Array.from({ length: 9 }, () => Array(9).fill(0)); // åˆå§‹åŒ–ç©ºæ£‹ç›¤
            
            fillDiagonal(); // å¡«å……å°è§’ç·šå€åŸŸ
            
            solveSudoku(board); // è§£æ•¸ç¨
            
            solution = JSON.parse(JSON.stringify(board)); // ä¿å­˜è§£ç­”
            
            let attempts = 0; // æ ¹æ“šé›£åº¦è¨­ç½®æŒ–ç©ºæ•¸é‡
            switch(difficulty) {
                case 'Beginner': attempts = 20; break; // å…¥é–€é›£åº¦ï¼š20å€‹ç©º
                case 'Easy': attempts = 30; break;     // ç°¡å–®é›£åº¦ï¼š30å€‹ç©º
                case 'Medium': attempts = 40; break;   // ä¸­ç­‰é›£åº¦ï¼š40å€‹ç©º
                case 'Hard': attempts = 50; break;     // å›°é›£é›£åº¦ï¼š50å€‹ç©º
                case 'Expert': attempts = 58; break;   // å°ˆå®¶é›£åº¦ï¼š58å€‹ç©º
            }
            
            initial = JSON.parse(JSON.stringify(solution)); // ä¿å­˜åˆå§‹ç›¤é¢
            
            board = Array.from({ length: 9 }, () => Array(9).fill(0)); // é‡ç½®æ£‹ç›¤
            
            let removed = 0; // å·²æŒ–ç©ºè¨ˆæ•¸
            // éš¨æ©ŸæŒ–ç©º
            while (removed < attempts) {
                let row = Math.floor(Math.random() * 9); // éš¨æ©Ÿè¡Œ
                let col = Math.floor(Math.random() * 9); // éš¨æ©Ÿåˆ—
                
                // å¦‚æœè©²ä½ç½®æœ‰æ•¸å­—ï¼Œå‰‡æŒ–ç©º
                if (initial[row][col] !== 0) {
                    initial[row][col] = 0;
                    removed++;
                }
            }
        }

        // å¡«å……å°è§’ç·šå€åŸŸ
        function fillDiagonal() {
            for (let i = 0; i < 9; i += 3) {
                fillBox(i, i); // å¡«å……3x3ç›’å­
            }
        }

        // å¡«å……3x3ç›’å­
        function fillBox(row, col) {
            let num;
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    // éš¨æ©Ÿç”Ÿæˆæ•¸å­—ï¼Œç›´åˆ°æ‰¾åˆ°å®‰å…¨çš„æ•¸å­—
                    do {
                        num = Math.floor(Math.random() * 9) + 1;
                    } while (!isSafeInBox(row, col, num));
                    
                    board[row + i][col + j] = num; // æ”¾ç½®æ•¸å­—
                }
            }
        }

        // æª¢æŸ¥æ•¸å­—åœ¨3x3ç›’å­ä¸­æ˜¯å¦å®‰å…¨
        function isSafeInBox(rowStart, colStart, num) {
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    // å¦‚æœæ•¸å­—å·²å­˜åœ¨ï¼Œå‰‡ä¸å®‰å…¨
                    if (board[rowStart + i][colStart + j] === num) return false;
                }
            }
            return true; // æ•¸å­—å®‰å…¨
        }

        // è§£æ•¸ç¨ï¼ˆå›æº¯ç®—æ³•ï¼‰
        function solveSudoku(grid) {
            for (let row = 0; row < 9; row++) {
                for (let col = 0; col < 9; col++) {
                    // å¦‚æœå–®å…ƒæ ¼ç‚ºç©º
                    if (grid[row][col] === 0) {
                        // å˜—è©¦1-9çš„æ•¸å­—
                        for (let num = 1; num <= 9; num++) {
                            // å¦‚æœæ•¸å­—å®‰å…¨
                            if (isSafe(grid, row, col, num)) {
                                grid[row][col] = num; // æ”¾ç½®æ•¸å­—
                                
                                // éæ­¸è§£æ±ºå‰©ä¸‹çš„éƒ¨åˆ†
                                if (solveSudoku(grid)) return true;
                                
                                grid[row][col] = 0; // å›æº¯
                            }
                        }
                        return false; // ç„¡è§£
                    }
                }
            }
            return true; // è§£æ±ºå®Œæˆ
        }

        // æª¢æŸ¥æ•¸å­—åœ¨è¡Œã€åˆ—å’Œ3x3ç›’å­ä¸­æ˜¯å¦å®‰å…¨
        function isSafe(grid, row, col, num) {
            // æª¢æŸ¥è¡Œ
            for (let x = 0; x < 9; x++) {
                if (grid[row][x] === num) return false;
            }
            
            // æª¢æŸ¥åˆ—
            for (let x = 0; x < 9; x++) {
                if (grid[x][col] === num) return false;
            }
            
            // æª¢æŸ¥3x3ç›’å­
            let startRow = row - row % 3;
            let startCol = col - col % 3;
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    if (grid[i + startRow][j + startCol] === num) return false;
                }
            }
            return true; // æ•¸å­—å®‰å…¨
        }

        // ä½¿ç”¨æç¤ºåŠŸèƒ½
        function useHint() {
            // å¦‚æœéŠæˆ²çµæŸæˆ–æš«åœï¼Œå‰‡ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
            if (gameOver || isPaused) return;
            
            const emptyCells = []; // ç©ºå–®å…ƒæ ¼åˆ—è¡¨
            // æ”¶é›†æ‰€æœ‰ç©ºå–®å…ƒæ ¼
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    if (board[r][c] === 0 && initial[r][c] === 0) {
                        emptyCells.push({r, c});
                    }
                }
            }
            
            // å¦‚æœæ²’æœ‰ç©ºå–®å…ƒæ ¼ï¼Œå‰‡ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
            if (emptyCells.length === 0) return;
            
            hintCount++; // å¢åŠ æç¤ºè¨ˆæ•¸
            updateStats(); // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
            
            // éš¨æ©Ÿé¸æ“‡ä¸€å€‹ç©ºå–®å…ƒæ ¼
            const { r, c } = emptyCells[Math.floor(Math.random() * emptyCells.length)];
            const correctNum = solution[r][c]; // ç²å–æ­£ç¢ºæ•¸å­—
            
            board[r][c] = correctNum; // æ›´æ–°éŠæˆ²ç›¤é¢
            updateBoardUI(); // æ›´æ–°æ£‹ç›¤UI
            
            const cellDiv = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
            cellDiv.classList.add('hinting'); // æ·»åŠ æç¤ºæ•ˆæœé¡
            // 2ç§’å¾Œç§»é™¤æç¤ºæ•ˆæœ
            setTimeout(() => {
                if (cellDiv) cellDiv.classList.remove('hinting');
            }, 2000);
            
            playSound('hint'); // æ’­æ”¾æç¤ºéŸ³æ•ˆ
            
            updateCounts(); // æ›´æ–°æ•¸å­—è¨ˆæ•¸
            updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
            
            checkWin(); // æª¢æŸ¥æ˜¯å¦ç²å‹
            
            isFreshGame = false; // æ¨™è¨˜éŠæˆ²å·²é–‹å§‹
        }

        // æ ¹æ“šåº§æ¨™ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
        function getCellDiv(r, c) {
            return document.querySelector(`.cell[data-r='${r}'][data-c='${c}']`);
        }

        // æ›´æ–°æ£‹ç›¤UI
        function updateBoardUI() {
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const cell = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
                    
                    // ç²å–å–®å…ƒæ ¼çš„å€¼ï¼ˆç©å®¶å¡«å¯«çš„æ•¸å­—æˆ–åˆå§‹ç·šç´¢ï¼‰
                    const val = board[r][c] !== 0 ? board[r][c] : initial[r][c];
                    
                    cell.querySelector('.main-num').innerText = val === 0 ? '' : val; // æ›´æ–°æ•¸å­—é¡¯ç¤º
                    
                    cell.className = 'cell'; // é‡ç½®å–®å…ƒæ ¼é¡
                    
                    // æ·»åŠ ä¹å®®æ ¼é‚Šæ¡†
                    if ((c + 1) % 3 === 0 && c !== 8) cell.classList.add('border-right');
                    if ((r + 1) % 3 === 0 && r !== 8) cell.classList.add('border-bottom');
                    
                    // æ ¹æ“šå–®å…ƒæ ¼é¡å‹æ·»åŠ ç›¸æ‡‰é¡
                    if (initial[r][c] !== 0) {
                        cell.classList.add('clue'); // åˆå§‹ç·šç´¢å–®å…ƒæ ¼
                    } else if (board[r][c] !== 0) {
                        cell.classList.add('filled'); // ç©å®¶å¡«å¯«çš„å–®å…ƒæ ¼
                    }
                }
            }
            
            // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨ï¼Œæ›´æ–°ç­†è¨˜
            if (notesEnabled) updateNotes();
            else clearNotes(); // å¦å‰‡æ¸…é™¤ç­†è¨˜
        }

        // åˆ‡æ›ç­†è¨˜æ¨¡å¼
        function toggleNotes() {
            // å¦‚æœéŠæˆ²æš«åœï¼Œå‰‡ä¸åŸ·è¡Œä»»ä½•æ“ä½œ
            if (isPaused) return;
            
            notesEnabled = !notesEnabled; // åˆ‡æ›ç­†è¨˜æ¨¡å¼ç‹€æ…‹
            
            const notesBtn = document.getElementById('btn-notes'); // ç²å–ç­†è¨˜æ¨¡å¼æŒ‰éˆ•
            // æ›´æ–°æŒ‰éˆ•æ¨£å¼
            if (notesEnabled) {
                notesBtn.classList.add('btn-on'); // é–‹å•Ÿç‹€æ…‹
                notesBtn.classList.remove('btn-secondary'); // ç§»é™¤æ¬¡è¦ç‹€æ…‹
            } else {
                notesBtn.classList.remove('btn-on'); // é—œé–‰ç‹€æ…‹
                notesBtn.classList.add('btn-secondary'); // æ·»åŠ æ¬¡è¦ç‹€æ…‹
            }
            
            // æ ¹æ“šç­†è¨˜æ¨¡å¼ç‹€æ…‹æ›´æ–°ç­†è¨˜é¡¯ç¤º
            if (notesEnabled) updateNotes();
            else clearNotes();
            
            updateHighlighting(); // æ›´æ–°é«˜äº®é¡¯ç¤º
        }

        // æ¸…é™¤æ‰€æœ‰ç­†è¨˜
        function clearNotes() {
            document.querySelectorAll('.note-num').forEach(el => el.innerText = ''); // æ¸…ç©ºæ‰€æœ‰ç­†è¨˜æ•¸å­—
        }

        // æ›´æ–°ç­†è¨˜
        function updateNotes() {
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const cell = getCellDiv(r, c); // ç²å–å–®å…ƒæ ¼DOMå…ƒç´ 
                    const noteContainer = cell.querySelector('.notes-grid'); // ç²å–ç­†è¨˜å®¹å™¨
                    
                    // æ¸…ç©ºæ‰€æœ‰ç­†è¨˜æ•¸å­—
                    noteContainer.querySelectorAll('.note-num').forEach(n => n.innerText = '');
                    
                    // å¦‚æœæ˜¯ç©ºå–®å…ƒæ ¼ï¼Œæ›´æ–°ç­†è¨˜
                    if (board[r][c] === 0 && initial[r][c] === 0) {
                        // åˆä½µåˆå§‹ç›¤é¢å’Œç©å®¶å¡«å¯«çš„æ•¸å­—
                        let combinedGrid = JSON.parse(JSON.stringify(initial));
                        for (let i = 0; i < 9; i++) {
                            for (let j = 0; j < 9; j++) {
                                if (board[i][j] !== 0) combinedGrid[i][j] = board[i][j];
                            }
                        }
                        
                        // æª¢æŸ¥æ¯å€‹æ•¸å­—æ˜¯å¦å®‰å…¨ï¼Œå®‰å…¨å‰‡é¡¯ç¤ºåœ¨ç­†è¨˜ä¸­
                        for (let n = 1; n <= 9; n++) {
                            if (isSafe(combinedGrid, r, c, n)) {
                                noteContainer.querySelector(`.note-num[data-num='${n}']`).innerText = n;
                            }
                        }
                    }
                }
            }
        }

        // æ›´æ–°é«˜äº®é¡¯ç¤º
        function updateHighlighting() {
            // ç§»é™¤æ‰€æœ‰é«˜äº®é¡
            document.querySelectorAll('.cell').forEach(c => {
                c.classList.remove('selected', 'highlight-related', 'highlight-same');
            });
            
            // ç§»é™¤æ‰€æœ‰ç­†è¨˜é«˜äº®é¡
            document.querySelectorAll('.note-num').forEach(n => {
                n.classList.remove('highlighted');
            });
            
            // ç§»é™¤æ‰€æœ‰å»ºè­°æ•¸å­—é«˜äº®é¡
            document.querySelectorAll('.numpad-btn').forEach(b => {
                b.classList.remove('suggested');
            });
            
            // å¦‚æœæ²’æœ‰é¸ä¸­çš„å–®å…ƒæ ¼ï¼Œå‰‡è¿”å›
            if (!selectedCell) return;
            
            const { r, c } = selectedCell; // ç²å–é¸ä¸­å–®å…ƒæ ¼åº§æ¨™
            
            // ç²å–é¸ä¸­å–®å…ƒæ ¼çš„å€¼
            const val = board[r][c] !== 0 ? board[r][c] : initial[r][c];
            
            const startRow = r - r % 3; // 3x3ç›’å­èµ·å§‹è¡Œ
            const startCol = c - c % 3; // 3x3ç›’å­èµ·å§‹åˆ—
            
            // é«˜äº®ç›¸é—œå–®å…ƒæ ¼ï¼ˆåŒä¸€è¡Œã€åŒä¸€åˆ—ã€åŒä¸€3x3ç›’å­ï¼‰
            for (let i = 0; i < 9; i++) {
                getCellDiv(r, i).classList.add('highlight-related'); // åŒä¸€è¡Œ
                getCellDiv(i, c).classList.add('highlight-related'); // åŒä¸€åˆ—
            }
            
            // åŒä¸€3x3ç›’å­
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    getCellDiv(startRow + i, startCol + j).classList.add('highlight-related');
                }
            }
            
            getCellDiv(r, c).classList.add('selected'); // é«˜äº®é¸ä¸­çš„å–®å…ƒæ ¼
            
            // å¦‚æœæœ‰å€¼ï¼Œé«˜äº®ç›¸åŒæ•¸å€¼çš„å–®å…ƒæ ¼
            if (val !== 0) {
                for (let i = 0; i < 9; i++) {
                    for (let j = 0; j < 9; j++) {
                        const cellVal = board[i][j] !== 0 ? board[i][j] : initial[i][j];
                        if (cellVal === val) {
                            getCellDiv(i, j).classList.add('highlight-same');
                        }
                    }
                }
                
                // å¦‚æœç­†è¨˜æ¨¡å¼å•Ÿç”¨ï¼Œé«˜äº®ç›¸åŒæ•¸å€¼çš„ç­†è¨˜
                if (notesEnabled) {
                    document.querySelectorAll(`.note-num[data-num='${val}']`).forEach(noteEl => {
                        if (noteEl.innerText === String(val)) {
                            noteEl.classList.add('highlighted');
                        }
                    });
                }
            }
            
            // å¦‚æœæ˜¯ç©ºå–®å…ƒæ ¼ï¼Œæª¢æŸ¥ä¸¦é«˜äº®å»ºè­°æ•¸å­—
            if (board[r][c] === 0 && initial[r][c] === 0) {
                checkGroupAndHighlight(r, c);
            }
        }

        // æª¢æŸ¥ä¸¦é«˜äº®å»ºè­°æ•¸å­—
        function checkGroupAndHighlight(r, c) {
            let rowValues = []; // è¡Œä¸­çš„æ•¸å­—
            // æ”¶é›†è¡Œä¸­çš„æ•¸å­—
            for (let i = 0; i < 9; i++) {
                const val = board[r][i] !== 0 ? board[r][i] : initial[r][i];
                rowValues.push(val);
            }
            let rowMissing = findMissingNumber(rowValues); // æŸ¥æ‰¾è¡Œä¸­ç¼ºå¤±çš„æ•¸å­—
            // å¦‚æœè¡Œä¸­åªæœ‰ä¸€å€‹ç¼ºå¤±æ•¸å­—ï¼Œé«˜äº®å®ƒ
            if (rowMissing !== -1) {
                highlightSuggestedNumber(rowMissing);
                return;
            }
            
            let colValues = []; // åˆ—ä¸­çš„æ•¸å­—
            // æ”¶é›†åˆ—ä¸­çš„æ•¸å­—
            for (let i = 0; i < 9; i++) {
                const val = board[i][c] !== 0 ? board[i][c] : initial[i][c];
                colValues.push(val);
            }
            let colMissing = findMissingNumber(colValues); // æŸ¥æ‰¾åˆ—ä¸­ç¼ºå¤±çš„æ•¸å­—
            // å¦‚æœåˆ—ä¸­åªæœ‰ä¸€å€‹ç¼ºå¤±æ•¸å­—ï¼Œé«˜äº®å®ƒ
            if (colMissing !== -1) {
                highlightSuggestedNumber(colMissing);
                return;
            }
            
            let boxValues = []; // 3x3ç›’å­ä¸­çš„æ•¸å­—
            const startRow = r - r % 3; // 3x3ç›’å­èµ·å§‹è¡Œ
            const startCol = c - c % 3; // 3x3ç›’å­èµ·å§‹åˆ—
            // æ”¶é›†3x3ç›’å­ä¸­çš„æ•¸å­—
            for (let i = 0; i < 3; i++) {
                for (let j = 0; j < 3; j++) {
                    const val = board[startRow + i][startCol + j] !== 0 ? 
                                board[startRow + i][startCol + j] : 
                                initial[startRow + i][startCol + j];
                    boxValues.push(val);
                }
            }
            let boxMissing = findMissingNumber(boxValues); // æŸ¥æ‰¾3x3ç›’å­ä¸­ç¼ºå¤±çš„æ•¸å­—
            // å¦‚æœ3x3ç›’å­ä¸­åªæœ‰ä¸€å€‹ç¼ºå¤±æ•¸å­—ï¼Œé«˜äº®å®ƒ
            if (boxMissing !== -1) {
                highlightSuggestedNumber(boxMissing);
                return;
            }
        }

        // æŸ¥æ‰¾ç¼ºå¤±çš„æ•¸å­—
        function findMissingNumber(values) {
            let missing = 0; // ç¼ºå¤±çš„æ•¸å­—
            let count = 0; // ç¼ºå¤±æ•¸å­—æ•¸é‡
            // æª¢æŸ¥1-9å“ªäº›æ•¸å­—ç¼ºå¤±
            for (let i = 1; i <= 9; i++) {
                if (!values.includes(i)) {
                    missing = i;
                    count++;
                }
            }
            // å¦‚æœåªæœ‰ä¸€å€‹ç¼ºå¤±æ•¸å­—ï¼Œè¿”å›å®ƒï¼›å¦å‰‡è¿”å›-1
            return count === 1 ? missing : -1;
        }

        // é«˜äº®å»ºè­°æ•¸å­—
        function highlightSuggestedNumber(num) {
            const btn = document.getElementById(`btn-num-${num}`); // ç²å–æ•¸å­—æŒ‰éˆ•
            if (btn) {
                btn.classList.add('suggested'); // æ·»åŠ å»ºè­°é¡
            }
        }

        // æ›´æ–°æ•¸å­—è¨ˆæ•¸
        function updateCounts() {
            counts.fill(9); // é‡ç½®è¨ˆæ•¸ç‚º9
            
            // çµ±è¨ˆæ¯å€‹æ•¸å­—å·²ä½¿ç”¨çš„æ•¸é‡
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const val = board[r][c] !== 0 ? board[r][c] : initial[r][c];
                    if (val !== 0) counts[val]--; // æ¸›å°‘å°æ‡‰æ•¸å­—çš„è¨ˆæ•¸
                }
            }
            
            // æ›´æ–°æ•¸å­—æŒ‰éˆ•çš„è¨ˆæ•¸é¡¯ç¤º
            for (let i = 1; i <= 9; i++) {
                const btn = document.getElementById(`btn-num-${i}`);
                btn.querySelector('.count').innerText = counts[i]; // æ›´æ–°è¨ˆæ•¸é¡¯ç¤º
                
                // å¦‚æœæ•¸å­—å·²ç”¨å®Œï¼Œæ·»åŠ æ·¡å‡ºæ•ˆæœ
                if (counts[i] <= 0) {
                    btn.classList.add('faded');
                } else {
                    btn.classList.remove('faded');
                }
            }
        }

        // æª¢æŸ¥æ˜¯å¦ç²å‹
        function checkWin() {
            let isFull = true; // æ˜¯å¦å¡«æ»¿æ¨™è¨˜
            
            // æª¢æŸ¥æ¯å€‹å–®å…ƒæ ¼æ˜¯å¦æ­£ç¢º
            for (let r = 0; r < 9; r++) {
                for (let c = 0; c < 9; c++) {
                    const cellVal = board[r][c] !== 0 ? board[r][c] : initial[r][c];
                    // å¦‚æœå–®å…ƒæ ¼å€¼ä¸æ­£ç¢º
                    if (cellVal !== solution[r][c]) {
                        isFull = false;
                        break;
                    }
                }
                if (!isFull) break;
            }
            
            // å¦‚æœæ‰€æœ‰å–®å…ƒæ ¼éƒ½æ­£ç¢º
            if (isFull) {
                gameOver = true; // æ¨™è¨˜éŠæˆ²çµæŸ
                stopTimer(); // åœæ­¢è¨ˆæ™‚å™¨
                playSound('win'); // æ’­æ”¾å‹åˆ©éŸ³æ•ˆ
                
                // æ›´æ–°å‹åˆ©ç•«é¢é¡¯ç¤º
                document.getElementById('victory-time-text').innerText = `Time: ${updateTimerDisplay()}`;
                document.getElementById('victory-stats').innerText = `Errors: ${errorCount.toString().padStart(2, '0')}, Hints: ${hintCount.toString().padStart(2, '0')}`;
                
                showVictoryScreen(); // é¡¯ç¤ºå‹åˆ©ç•«é¢
                
                // ç§»é™¤æ‰€æœ‰é«˜äº®
                document.querySelectorAll('.cell').forEach(c => {
                    c.classList.remove('selected', 'highlight-related', 'highlight-same');
                });
            }
        }

        // é¡¯ç¤ºå‹åˆ©ç•«é¢
        function showVictoryScreen() {
            document.getElementById('victory-overlay').style.display = 'flex'; // é¡¯ç¤ºå‹åˆ©ç•«é¢é®ç½©å±¤
            
            createChristmasLights(); // å‰µå»ºè–èª•ç‡ˆé£¾
        }

        // å‰µå»ºè–èª•ç‡ˆé£¾
        function createChristmasLights() {
            const lightsContainer = document.getElementById('christmas-lights'); // ç²å–ç‡ˆé£¾å®¹å™¨
            lightsContainer.innerHTML = ''; // æ¸…ç©ºå®¹å™¨
            
            const lightColors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ff8000', '#8000ff']; // ç‡ˆé£¾é¡è‰²
            
            // å‰µå»º12å€‹ç‡ˆæ³¡
            for (let i = 0; i < 12; i++) {
                const light = document.createElement('div');
                light.className = 'light';
                light.style.backgroundColor = lightColors[i % lightColors.length]; // è¨­ç½®é¡è‰²
                light.style.animationDelay = `${i * 0.2}s`; // è¨­ç½®å‹•ç•«å»¶é²
                
                lightsContainer.appendChild(light); // å°‡ç‡ˆæ³¡æ·»åŠ åˆ°å®¹å™¨
            }
        }

        // é—œé–‰é®ç½©å±¤
        function closeOverlay() {
            document.getElementById('victory-overlay').style.display = 'none'; // éš±è—å‹åˆ©ç•«é¢é®ç½©å±¤
            
            startNewGame(); // é–‹å§‹æ–°éŠæˆ²
        }

        // åˆ‡æ›éŸ³æ•ˆç‹€æ…‹
        function toggleSound() {
            soundEnabled = !soundEnabled; // åˆ‡æ›éŸ³æ•ˆç‹€æ…‹
            
            const soundBtn = document.getElementById('btn-sound'); // ç²å–éŸ³æ•ˆæŒ‰éˆ•
            // æ›´æ–°æŒ‰éˆ•åœ–æ¨™å’Œæç¤º
            if (soundEnabled) {
                soundBtn.innerHTML = 'ğŸ”Š';
                soundBtn.title = 'Sound On';
            } else {
                soundBtn.innerHTML = 'ğŸ”‡';
                soundBtn.title = 'Sound Off';
            }
        }
    </script>
</body>
</html>